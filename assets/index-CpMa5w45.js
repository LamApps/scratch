var Tt=Object.defineProperty;var Pt=(o,i,t)=>i in o?Tt(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t;var n=(o,i,t)=>(Pt(o,typeof i!="symbol"?i+"":i,t),t);import{n as tt,o as T,C as m,b as y,q as X,t as w,G as S,u as Y,T as W,v as Lt,w as Ft,x as D,y as yt,z as rt,H as At,R as Mt,j as U,I as Rt,J as Et,K as zt}from"./@pixi-DoOeBslk.js";import"./pixi.js-CnUX8r_4.js";import"./eventemitter3-Bav5T-Ru.js";import"./earcut-DOWYkTK5.js";import"./url-J8SwAPIS.js";import{a as F}from"./axios-Cm0UX6qg.js";import{g as u}from"./gsap-ZORhgBxb.js";import{S as j}from"./@pixi-spine-1RzxFvll.js";import"./typed-signals-Bqx_1MKE.js";import"./tweedle.js-CzjNpvYT.js";import"./ismobilejs-CHLuctl-.js";import"./call-bind-CkPzBTRv.js";import"./get-intrinsic-B1Ut8WxJ.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-B8G-TZ45.js";import"./hasown-B9bXSDSU.js";import"./set-function-length-Ct5B6P4y.js";import"./define-data-property-CUxyvwXF.js";import"./es-define-property-28jGrh5V.js";import"./gopd-O61WwtTx.js";import"./has-property-descriptors-Cvfij9iw.js";import"./side-channel-CzTPmnEc.js";import"./object-inspect-CJVVCa5F.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();const G="https://5748-scratchcards-api-piec-zam-393.ggworld.work/api/v1/scratchcards",V="scratch-cards-test-game",_=1920,b=1080,Ot=0,Nt=320,Gt=582.5,q="volume-bgm",lt="volume-bgm-prev",K="volume-sfx",ct="volume-sfx-prev",J=4,Vt=65,C=830,M=[1,5,10,25,50],It="BRL",dt={language:"lang",currency:"cur"},Wt={BRL:"R$",USD:"$",EUR:"€",GBP:"£",JPY:"¥",KRW:"₩",NGN:"₦",PHP:"₱",RUB:"₽",THB:"฿",CRC:"₡",INR:"₹",TRY:"₺"},H={Portuguese:"pt",English:"en",Spanish:"sp",French:"fr"};class _t{constructor(){n(this,"currentAlias");n(this,"current");n(this,"volume",1)}async play(i,t){if(this.currentAlias!==i){if(this.current){const e=this.current;u.killTweensOf(e),u.to(e,{volume:0,duration:1,ease:"linear"}).then(()=>{e.stop()})}this.current=tt.find(i),this.currentAlias=i,this.current.play({loop:!0,...t}),this.current.volume=0,u.killTweensOf(this.current),u.to(this.current,{volume:this.volume,duration:1,ease:"linear"})}}getVolume(){return this.volume}setVolume(i){this.volume=i,this.current&&(this.current.volume=this.volume)}}class Ht{constructor(){n(this,"volume",1)}play(i,t){const e=this.volume*((t==null?void 0:t.volume)??1);tt.play(i,{...t,volume:e})}getVolume(){return this.volume}setVolume(i){this.volume=i}}const I=new _t,x=new Ht;class $t{getString(i){return localStorage.getItem(i)??void 0}setString(i,t){localStorage.setItem(i,t)}getNumber(i){const t=this.getString(i)??void 0,e=Number(t);return isNaN(e)?null:e}setNumber(i,t){this.setString(i,String(t))}getBool(i){const t=localStorage.getItem(i);return t?!!t.toLowerCase():void 0}setBool(i,t){localStorage.setItem(i,String(t))}getObject(i){const t=this.getString(i);if(t)try{return JSON.parse(t)}catch(e){console.warn(e);return}}setObject(i,t){this.setString(i,JSON.stringify(t))}}const v=new $t;function ut(o){const i=window.location.search;return new URLSearchParams(i).get(o)}class Dt{constructor(){n(this,"state",{ticketPrice:0,ticketPool:0,prizes:[],roundResult:{ticketsLeft:0,cards:[],prize:0,balance:0,currency:""},isGameStarted:!1,isScratched:!1,buyTickets:1,ticketsLeft:0,credit:1e3,totalWin:0,win:0,isAutoPlay:!1,isMuteSFX:!0,isMuteBGM:!0,language:ut(dt.language)||H.Portuguese,currency:ut(dt.currency)||It});I.setVolume(0),x.setVolume(0)}getBgmVolume(){return v.getNumber(q)??0}setBgmVolume(i){i<=0?this.state.isMuteBGM=!0:this.state.isMuteBGM=!1,I.setVolume(i),v.setNumber(q,i),v.setNumber(lt,i)}muteBGM(){I.setVolume(0),v.setNumber(q,0)}unMuteBGM(){let i=v.getNumber(lt)??.5;i<=0&&(i=.5),I.setVolume(i),v.setNumber(q,i)}getSfxVolume(){return v.getNumber(K)??0}setSfxVolume(i){i<=0?this.state.isMuteSFX=!0:this.state.isMuteSFX=!1,x.setVolume(i),v.setNumber(K,i),v.setNumber(ct,i)}muteSFX(){x.setVolume(0),v.setNumber(K,0)}unMuteSFX(){let i=v.getNumber(ct)??.5;i<=0&&(i=.5),x.setVolume(i),v.setNumber(K,i)}get currentState(){return this.state}setGameState(i){this.state={...this.state,...i}}}const r=new Dt;let et={bundles:[]};const at=[];function Ut(o){return!!et.bundles.find(i=>i.name===o)}async function ot(o,i=null){typeof o=="string"&&(o=[o]);for(const e of o)if(!Ut(e))throw new Error(`[Assets] Invalid bundle: ${e}`);const t=o.filter(e=>!at.includes(e));t.length&&(console.log("[Assets] Load:",t.join(", ")),i?await T.loadBundle(t,i):await T.loadBundle(t),at.push(...t))}function jt(o){for(const i of o)if(!at.includes(i))return!1;return!0}async function Xt(o){const t=await(await fetch(o)).json();if(!t.bundles)throw new Error("[Assets] Invalid assets manifest");return t}async function Yt(){et=await Xt("assets/assets-manifest.json"),await T.init({manifest:et,basePath:"assets"});try{await T.load(`i18n/${r.currentState.language}.json`)}catch{r.currentState.language=H.English,await T.load(`i18n/${r.currentState.language}.json`)}await ot("preload")}function qt(){return et.bundles.filter(o=>o.name!=="default").map(o=>o.name)}class Kt{constructor(i){n(this,"ctor");n(this,"list",[]);this.ctor=i}get(){return this.list.pop()??new this.ctor}giveBack(i){this.list.includes(i)||this.list.push(i)}}class Jt{constructor(){n(this,"map",new Map)}get(i){let t=this.map.get(i);return t||(t=new Kt(i),this.map.set(i,t)),t.get()}giveBack(i){const t=this.map.get(i.constructor);t&&t.giveBack(i)}}const Zt=new Jt;class Qt{constructor(){n(this,"container",new m);n(this,"width",0);n(this,"height",0);n(this,"background");n(this,"currentScreen");n(this,"currentPopup")}setBackground(i){this.background=new i,this.addAndShowScreen(this.background)}async addAndShowScreen(i){this.container.parent||B.stage.addChild(this.container),this.container.addChild(i),i.prepare&&i.prepare(),i.resize&&i.resize(this.width,this.height),i.update&&B.ticker.add(i.update,i),i.show&&(i.interactiveChildren=!1,await i.show(),i.interactiveChildren=!0)}async hideAndRemoveScreen(i){i.interactiveChildren=!1,i.hide&&await i.hide(),i.update&&B.ticker.remove(i.update,i),i.parent&&i.parent.removeChild(i),i.reset&&i.reset()}async showScreen(i){this.currentScreen&&(this.currentScreen.interactiveChildren=!1),i.assetBundles&&!jt(i.assetBundles)&&await ot(i.assetBundles),this.currentScreen&&await this.hideAndRemoveScreen(this.currentScreen),this.currentScreen=Zt.get(i),await this.addAndShowScreen(this.currentScreen)}resize(i,t){var e,s,a,h,g,c;this.width=i,this.height=t,(s=(e=this.currentScreen)==null?void 0:e.resize)==null||s.call(e,i,t),(h=(a=this.currentPopup)==null?void 0:a.resize)==null||h.call(a,i,t),(c=(g=this.background)==null?void 0:g.resize)==null||c.call(g,i,t)}async presentPopup(i,t=null){var e,s;this.currentScreen&&(this.currentScreen.interactiveChildren=!1,await((s=(e=this.currentScreen).pause)==null?void 0:s.call(e))),this.currentPopup&&await this.hideAndRemoveScreen(this.currentPopup),t?this.currentPopup=new i(t):this.currentPopup=new i,await this.addAndShowScreen(this.currentPopup)}async dismissPopup(){var t,e;if(!this.currentPopup)return;const i=this.currentPopup;this.currentPopup=void 0,await this.hideAndRemoveScreen(i),this.currentScreen&&(this.currentScreen.interactiveChildren=!0,(e=(t=this.currentScreen).resume)==null||e.call(t))}blur(){var i,t,e,s,a,h;(t=(i=this.currentScreen)==null?void 0:i.blur)==null||t.call(i),(s=(e=this.currentPopup)==null?void 0:e.blur)==null||s.call(e),(h=(a=this.background)==null?void 0:a.blur)==null||h.call(a)}focus(){var i,t,e,s,a,h;(t=(i=this.currentScreen)==null?void 0:i.focus)==null||t.call(i),(s=(e=this.currentPopup)==null?void 0:e.focus)==null||s.call(e),(h=(a=this.background)==null?void 0:a.focus)==null||h.call(a)}}const l=new Qt;class te extends m{constructor(){super();n(this,"image");this.image=y.from("preload/logo.png"),this.image.anchor.set(.5),this.addChild(this.image)}}class bt extends m{constructor(){super();n(this,"image");this.image=y.from("frame"),this.image.anchor.set(.5),this.addChild(this.image)}}Math.min(window.screen.width,window.screen.height)<768||navigator.userAgent.indexOf("Mobi")>-1;const p=()=>T.get(`i18n/${r.currentState.language}.json`)??T.get(`i18n/${H.English}.json`),O=()=>Wt[r.currentState.currency]||r.currentState.currency;function A(){return window.innerWidth<window.innerHeight}function N(o,i=!0){const t=o.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return i?t:t.split(".")[0]}const nt={};function wt(o,i,t){nt[o]||(t(),nt[o]=setTimeout(()=>delete nt[o],i))}const R=new X({fontFamily:"NotoSans Black",fontSize:30,fill:["#f9ffc9","#e0cb1c"],dropShadow:!0,dropShadowColor:"#000000",dropShadowAlpha:.5,dropShadowBlur:0,dropShadowAngle:Math.PI/2,dropShadowDistance:4,align:"center",lineJoin:"round"}),ht=new X({fontFamily:"NotoSans Black",lineHeight:38,fill:["#ffffff","#fffcca"],stroke:"#691201",strokeThickness:4,align:"center",lineJoin:"round"}),ee={...ht,fill:["#ffffff","#cff7ff"],stroke:"#072f6a"},ie={...ht,stroke:"#0b3b00"},St=new X({dropShadow:!0,dropShadowColor:"#020454",dropShadowBlur:2,dropShadowDistance:4,fill:"#ffffff",fontFamily:"NotoSans Black",fontSize:30,lineJoin:"round",stroke:"#2b93d7",align:"center",strokeThickness:4}),z=new X({fontFamily:"NotoSans Black",fontSize:20,letterSpacing:-3,fill:"#ffffff",align:"center"}),Z=new X({fontFamily:"NotoSans Black",fontSize:50,stroke:"#ffffff",strokeThickness:4,dropShadow:!0,dropShadowColor:"#880040",dropShadowAlpha:.5,dropShadowBlur:0,dropShadowAngle:Math.PI/4,dropShadowDistance:6,fill:"#e71477",align:"center"});class se extends m{constructor(){super();n(this,"backgroundImage");n(this,"globe");n(this,"title");n(this,"titleMobile");n(this,"matchText");this.alpha=0,this.backgroundImage=y.from("home/background.jpg"),this.backgroundImage.anchor.set(.5),this.addChild(this.backgroundImage);let t=T.cache.get("home/spine/cst_bg_anim.json");this.globe=new j(t.spineData),this.globe.autoUpdate=!0,this.globe.state.setAnimation(0,"default",!0),this.addChild(this.globe);const e=r.currentState.language===H.Portuguese?r.currentState.language:H.English;t=T.cache.get(`home/spine/cst_logo_${e}_anim.json`),this.title=new j(t.spineData),this.title.autoUpdate=!0,this.addChild(this.title),t=T.cache.get(`home/spine/cst_logo1_${e}_anim.json`),this.titleMobile=new j(t.spineData),this.titleMobile.autoUpdate=!0,this.addChild(this.titleMobile),this.matchText=new w(p().match3,{...St,fontSize:35}),this.matchText.roundPixels=!0,this.matchText.anchor.set(.5),this.addChild(this.matchText)}resize(t,e){this.backgroundImage.x=t*.5,this.backgroundImage.y=e*.5,A()?(this.titleMobile.x=t*.5,this.titleMobile.y=115,this.titleMobile.visible=!0,this.title.visible=!1,l.currentPopup||(this.titleMobile.state.setAnimation(0,"default",!0),this.title.state.setEmptyAnimations(0)),this.globe.x=t*.5,this.globe.y=e*.5-50,this.matchText.visible=!1):(this.title.x=256,this.title.y=163,this.title.visible=!0,this.titleMobile.visible=!1,l.currentPopup||(this.title.state.setAnimation(0,"default",!0),this.titleMobile.state.setEmptyAnimations(0)),this.globe.x=t*.5-720,this.globe.y=e*.5,this.matchText.x=250,this.matchText.y=320,this.matchText.visible=!0)}async show(){u.killTweensOf(this),await u.to(this,{alpha:1,duration:.6,ease:"linear",delay:1})}pause(){this.title.state.setEmptyAnimations(0),this.titleMobile.state.setEmptyAnimations(0),this.globe.state.setEmptyAnimations(0)}resume(){this.title.state.setAnimation(0,"default",!0),this.titleMobile.state.setAnimation(0,"default",!0),this.globe.state.setAnimation(0,"default",!0)}}function xt(o){const i=new w(o,{...z,fontSize:25}),t=new S;return t.beginFill(0,.5),t.drawRoundedRect(0,0,i.width+40,i.height+20,(i.height+20)/2),t.moveTo((i.width+40)/2-10,0),t.lineTo((i.width+40)/2,-10),t.lineTo((i.width+40)/2+10,0),t.closePath(),t.endFill(),i.anchor.set(.5),i.x=t.width/2,i.y=t.height/2-5,t.addChild(i),t}class E extends Y{constructor(t,e,s,a,h=1){const g=y.from(`button-${t}`),c=y.from(`button-${t}-hover`),d=y.from(`button-${t}-down`),f=y.from(`button-${t}`);h<1&&(g.scale.set(h),c.scale.set(h),d.scale.set(h));super({padding:t==="yellow"?25:18,animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}});n(this,"labelTextStyle");this.defaultView=g,this.hoverView=c,this.pressedView=d,this.disabledView=f,this.anchor.set(.5);const k=t==="yellow"?ht:t==="blue"?ee:ie;this.text=new w(s,{...k,...a}),this.labelTextStyle={...k,...a},this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(e)}changeLabel(t){this.textView=new w(t,this.labelTextStyle)}}class ne extends Y{constructor(i){const t=y.from("button-setting"),e=y.from("button-setting");e.tint=16645788;const s=xt(p().settingsTitle);s.x=-(s.width-e.width)/2,s.y=115,e.addChild(s);const a=y.from("button-setting");a.tint=11184810,super({animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}}),this.defaultView=t,this.hoverView=e,this.pressedView=a,this.anchor.set(.5),this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(i)}}class pt extends Y{constructor(t){super({animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}});n(this,"audioOn",!1);n(this,"texture");n(this,"normalSprite");n(this,"disabledSprite");n(this,"buttonType");this.buttonType=t,this.texture=W.from(`button-${t}`),this.normalSprite=new y(this.texture);const e=new y(this.texture);e.tint=16645788;const s=xt(p()[t]);s.x=-(s.width-e.width)/2,s.y=115,e.addChild(s);const a=new y(this.texture);a.tint=11184810,this.disabledSprite=new y(this.texture),this.disabledSprite.tint=7829367,this.defaultView=this.audioOn?this.normalSprite:this.disabledSprite,this.hoverView=e,this.pressedView=a,this.anchor.set(.5),this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(()=>{this.audioOn=!this.audioOn,this.audioOn?this.defaultView=this.normalSprite:this.defaultView=this.disabledSprite,this.buttonType==="bgm"?(r.currentState.isMuteBGM=!r.currentState.isMuteBGM,r.currentState.isMuteBGM?r.muteBGM():r.unMuteBGM()):(r.currentState.isMuteSFX=!r.currentState.isMuteSFX,r.currentState.isMuteSFX?r.muteSFX():r.unMuteSFX())})}updateState(){this.audioOn=!(this.buttonType==="bgm"?r.currentState.isMuteBGM:r.currentState.isMuteSFX),this.defaultView=this.audioOn?this.normalSprite:this.disabledSprite}}class gt extends Y{constructor(i,t=!0){const e=y.from(t?"next":"prev"),s=y.from(t?"next":"prev");s.tint=16645788;const a=y.from(t?"next":"prev");a.tint=11184810;const h=y.from(t?"next":"prev");h.tint=5592405,super({animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}}),this.defaultView=e,this.hoverView=s,this.pressedView=a,this.disabledView=h,this.anchor.set(.5),this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(i)}}class ae extends Y{constructor(i){const t=new S().lineStyle(2,15856113,.5).beginFill().drawRoundedRect(0,0,220,70,35).endFill(),e=new S().lineStyle(2,15856113,.5).beginFill().drawRoundedRect(0,0,220,70,35).endFill(),s=new S().lineStyle(2,15856113,.5).beginFill().drawRoundedRect(0,0,220,70,35).endFill();super({animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}}),this.defaultView=t,this.hoverView=e,this.pressedView=s,this.text=new w(p().settingsDone,{...z,fontSize:30}),this.anchor.set(.5),this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(i)}}class re extends m{constructor(t){super();n(this,"radioGroup");n(this,"priceTable");const e=new w(p().buyCardsToPlay,{...R,fontSize:45});e.anchor.set(.5),e.y=-320,this.addChild(e),this.priceTable=new m;const s=[];for(let h=0;h<M.length;h++)s.push(new Lt({text:`${M[h]} ${h===0?p().game:p().games}`,style:{unchecked:"radio",checked:"radio_checked",text:{...R,fontSize:35,fill:16776363},textOffset:{x:10}}}));this.radioGroup=new Ft({selectedItem:0,items:s,type:"vertical",elementsMargin:40}),this.radioGroup.onChange.connect((h,g)=>{x.play("home/sfx-click1.ogg"),t({id:h,val:g})}),this.priceTable.addChild(this.radioGroup);const a=new D({elementsMargin:30,vertPadding:10,horPadding:0,type:"vertical"});for(let h=0;h<M.length;h++){const g=new m;let c=M[h]===25?5:M[h]===50?10:0;if(M[h]>=25&&g.addChild(new w(p().save+" "+c+"%",{...R,fontSize:35,fill:7077687})),h<M.length-1){const f=new S;f.lineStyle(3,16776363,1),f.moveTo(-270,60),f.lineTo(380,60),g.addChild(f)}const d=new w(O()+" "+N(M[h]*r.currentState.ticketPrice-M[h]*r.currentState.ticketPrice*c/100),{...R,fontSize:30,fill:16776363});d.x=230,g.addChild(d),a.addChild(g)}a.x=250,this.priceTable.addChild(a),this.priceTable.x=-300,this.priceTable.y=-220,this.addChild(this.priceTable)}}class oe extends m{constructor(t){super();n(this,"paytable");n(this,"list");n(this,"button");this.paytable=new m;let e=[[p().tier,p().prizesAvailable,p().award]];for(let a=0;a<r.currentState.prizes.length;a++){const h=r.currentState.prizes[a];e.push([String(a+1),N(h.occurrences,!1),O()+" "+N(Number(h.amount))])}e=[...e,[p().totalTickets+" "+N(r.currentState.ticketPool,!1)],[p().insideTheGame],[p().theoreticalRTP]];const s=[];for(let a=0;a<e.length;a++){const h=new m;if(a<r.currentState.prizes.length+1){for(let c=0;c<3;c++){const d=new w(e[a][c],{...R,fill:16776363});c===1&&(d.x=120),c===2&&(d.x=450),h.addChild(d)}const g=new S;g.lineStyle(2,16776363,1),g.moveTo(0,40),g.lineTo(650,40),h.addChild(g)}else{const g=new w(e[a][0],{...R,fill:16776363,align:"left"});g.y=20,h.addChild(g)}s.push(h)}this.list=new D({children:s,type:"vertical"}),this.paytable.addChild(this.list),this.paytable.x=-320,this.paytable.y=-380,this.button=new E("green",t,p().back,{fontSize:33}),this.button.x=320,this.button.y=730,this.paytable.addChild(this.button),this.addChild(this.paytable)}}class he extends m{constructor(){super();n(this,"spinner");this.spinner=y.from("spinner"),this.spinner.anchor.set(.5),this.addChild(this.spinner)}show(){this.spinner.rotation=0,u.to(this.spinner,{rotation:Math.PI*2,repeat:-1,ease:"linear",duration:2})}hide(){u.killTweensOf(this.spinner)}}class ft extends m{constructor(t,e,s=-.1,a=100){super();n(this,"label");n(this,"slider");const h=320,g=20,c=10,d=4,f=14,k=16769565,P=16775805,$=3845650,st=new S().beginFill($).drawRoundedRect(0,0,h,g,c).beginFill(3845650).drawRoundedRect(d,d,h-d*2,g-d*2,c).endFill(),kt=new S().beginFill($).drawRoundedRect(0,0,h,g,c).beginFill(P).drawRoundedRect(d,d,h-d*2,g-d*2,c).endFill(),vt=new S().beginFill(k).drawCircle(0,0,f).endFill();this.slider=new yt({bg:st,fill:kt,slider:vt,min:s,max:a,value:e}),this.addChild(this.slider),this.label=new w(t,{...R,align:"left",fontSize:30}),this.label.anchor.x=0,this.label.x=10,this.label.y=-38,this.addChild(this.label)}connectOnUpdate(t){this.slider.onUpdate.connect(t)}}class le extends yt{constructor(i,t){const f=new S().beginFill(3845650).drawRoundedRect(0,0,800,20,10).endFill(),k=new S().beginFill(16775805).drawRoundedRect(0,0,800,20,10).endFill(),P=new S().beginFill(16769565).drawCircle(0,0,30).endFill();super({bg:f,fill:k,slider:P,min:1,max:i,value:1,valueTextStyle:{fill:0,fontSize:30},showValue:!0}),this.onUpdate.connect(t)}}class ce extends m{constructor(){super();n(this,"title");n(this,"doneButton");n(this,"historyButton");n(this,"layout");n(this,"bgmSlider");n(this,"sfxSlider");this.title=new w(p().settingsTitle,{...R,fontFamily:"NotoSans Black",fontSize:50}),this.title.anchor.set(.5),this.title.y=-250,this.addChild(this.title),this.historyButton=new E("green",()=>{var t,e;(e=(t=l==null?void 0:l.currentPopup)==null?void 0:t.gate)==null||e.call(t,"switchPanel")},p().settingsHistory,{fontSize:25}),this.historyButton.y=110,this.addChild(this.historyButton),this.doneButton=new E("green",()=>{l.dismissPopup()},p().settingsDone,{fontSize:35}),this.doneButton.y=220,this.addChild(this.doneButton),this.layout=new D({type:"vertical",elementsMargin:25}),this.layout.x=-160,this.layout.y=-160,this.addChild(this.layout),this.bgmSlider=new ft(p().settingsBgm,r.getBgmVolume()*100),this.bgmSlider.connectOnUpdate(t=>{var e,s;r.setBgmVolume(t/100),(s=(e=l==null?void 0:l.currentScreen)==null?void 0:e.gate)==null||s.call(e,"updateBGMButton")}),this.layout.addChild(this.bgmSlider),this.sfxSlider=new ft(p().settingsSfx,r.getSfxVolume()*100),this.sfxSlider.connectOnUpdate(t=>{var e,s;r.setSfxVolume(t/100),(s=(e=l==null?void 0:l.currentScreen)==null?void 0:e.gate)==null||s.call(e,"updateSFXButton")}),this.layout.addChild(this.sfxSlider)}}class Q extends m{constructor(t){super();n(this,"cardBackground");n(this,"renderTexture");n(this,"renderTextureSprite");n(this,"cardCover");n(this,"dragging",!1);n(this,"brush");n(this,"cards");n(this,"cardRevealed",[]);n(this,"symbolSprites",[]);n(this,"sameCards",{});n(this,"cardBackHighlightTexture",W.from("card_back_highlight"));n(this,"scratchSoundIndex",0);n(this,"isScratched",!1);const e=[-275,0,275],s=[-275,0,275];this.cards=t,this.brush=y.from("brush"),this.brush.anchor.set(.5),this.cardCover=new m;const a=W.from("card_cover");this.cardBackground=new m;const h=W.from("card_back"),g={};r.currentState.prizes.map(d=>{g[d.symbols[0]]=d.amount});for(let d=0;d<t.length;d++){let f=new y(a);f.anchor.set(.5),f.x=e[d%3],f.y=s[Math.floor(d/3)],this.cardCover.addChild(f),this.symbolSprites[d]=new y(h),this.symbolSprites[d].anchor.set(.5),this.symbolSprites[d].x=e[d%3],this.symbolSprites[d].y=s[Math.floor(d/3)];const k=T.cache.get(`home/spine/cst_element${t[d]}_anim.json`),P=new j(k.spineData);P.autoUpdate=!1,P.state.setAnimation(0,"default",!1),P.state.tracks[0].trackTime=0,P.update(0),this.symbolSprites[d].addChild(P);let $="";t[d]===0?$=p().freeplayCapital:$=O()+" "+String(g[t[d]]);const L=new rt($,{fontName:"impact_night",fontSize:40,letterSpacing:-10,align:"center"});if(L.anchor.set(.5),L.width>270){const st=L.width/L.height;L.width=250,L.height=250/st}L.y=95,L.x=5,this.symbolSprites[d].addChild(L),this.cardBackground.addChild(this.symbolSprites[d])}const c=new S;c.beginFill(16181525),c.drawRect(-(C/2),-(C/2),C,C),c.endFill(),this.addChild(c),this.renderTexture=At.create({width:C,height:C}),this.renderTextureSprite=new y(this.renderTexture),this.renderTextureSprite.anchor.set(.5),this.cardBackground.mask=this.renderTextureSprite,this.addChild(this.cardCover,this.cardBackground,this.renderTextureSprite),this.eventMode="static",this.hitArea=new Mt(-(C/2),-(C/2),C,C),this.on("pointermove",this.pointerMove).on("pointerdown",this.pointerDown).on("pointerup",this.pointerUp).on("pointerupoutside",this.pointerUp)}pointerMove(t){if(!this.dragging)return;const{x:e,y:s}=t.data.getLocalPosition(this),a=e+C/2,h=s+C/2;this.brush.position.set(a,h),B.renderer.render(this.brush,{renderTexture:this.renderTexture,clear:!1,skipUpdateTransform:!1}),x.play(`home/sfx-scratch${this.scratchSoundIndex}.ogg`),this.scratchSoundIndex++,this.scratchSoundIndex>10&&(this.scratchSoundIndex=0),wt("isScratching",200,()=>{if(this.getPaintedPercentage())this.reveal();else{this.sameCards={},this.cardRevealed.map((g,c)=>{g&&(this.sameCards[this.cards[c]]?this.sameCards[this.cards[c]].push(c):this.sameCards[this.cards[c]]=[c])});for(const g in this.sameCards)if(this.sameCards[g].length>1)for(let c=0;c<this.sameCards[g].length;c++){const d=this.symbolSprites[this.sameCards[g][c]].getChildAt(0);u.isTweening(d)||(u.to(d,{alpha:.3,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}),x.play("home/sfx-hint.ogg"));const f=this.symbolSprites[this.sameCards[g][c]].getChildAt(1);u.isTweening(f)||u.to(f,{alpha:.3,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"})}}})}pointerDown(t){this.dragging=!0,this.pointerMove(t)}pointerUp(){this.dragging=!1}getPaintedPercentage(){const t=B.renderer.extract.pixels(this.renderTexture),e=t.length/J,s=e/9,a=Math.sqrt(e),h=a/3,g=new Array(9).fill(0);for(let d=0;d<t.length;d+=J){const f=Math.floor(Math.floor(d/J)%a/h),P=3*Math.floor(Math.floor(d/J)/a/h)+f;t[d+3]===255&&g[P]++}let c=!0;for(let d=0;d<9;d++){const f=g[d];this.cardRevealed[d]=f*100/s>Vt,c=c&&this.cardRevealed[d]}return this.isScratched=c,c}showResult(){var t=new S;t.beginFill(16777215),t.drawRect(0,0,C,C),t.endFill(),this.eventMode="none",B.renderer.render(t,{renderTexture:this.renderTexture,clear:!1,skipUpdateTransform:!1}),this.sameCards={};for(let e=0;e<9;e++)this.sameCards[this.cards[e]]?this.sameCards[this.cards[e]].push(e):this.sameCards[this.cards[e]]=[e];for(const e in this.sameCards)if(this.sameCards[e].length>2)for(let s=0;s<this.sameCards[e].length;s++)this.symbolSprites[this.sameCards[e][s]].texture=this.cardBackHighlightTexture}reveal(){this.dragging=!1;let t=0;const e=()=>{var a,h;var s=new S;if(s.beginFill(16777215),s.drawRect(0,0,C,t),s.endFill(),B.renderer.render(s,{renderTexture:this.renderTexture,clear:!1,skipUpdateTransform:!1}),t+=40,t>840){B.ticker.remove(e);const g=[];this.eventMode="none",this.isScratched=!0,this.sameCards={};for(let c=0;c<9;c++)this.sameCards[this.cards[c]]?this.sameCards[this.cards[c]].push(c):this.sameCards[this.cards[c]]=[c];for(const c in this.sameCards)if(this.sameCards[c].length>=3&&g.push(Number(c)),this.sameCards[c].length>1)for(let d=0;d<this.sameCards[c].length;d++){const f=this.symbolSprites[this.sameCards[c][d]].getChildAt(0),k=this.symbolSprites[this.sameCards[c][d]].getChildAt(1);u.killTweensOf(f),u.killTweensOf(k),k.alpha=1,f.alpha=1,this.sameCards[c].length>=3&&(this.symbolSprites[this.sameCards[c][d]].texture=this.cardBackHighlightTexture,f.autoUpdate=!0,f.state.setAnimation(0,"default",!0),Number(c)>0&&u.to(k.scale,{x:1.2,y:1.2,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}))}(h=(a=l==null?void 0:l.currentScreen)==null?void 0:a.gate)==null||h.call(a,"finishRound",g)}};B.ticker.add(e)}pause(){if(this.isScratched)for(let t=0;t<9;t++){const e=this.symbolSprites[t].getChildAt(0);if(e.autoUpdate=!1,e.state.setAnimation(0,"default",!1),e.state.tracks[0].trackTime=0,e.update(0),this.cards[t]>0){const s=this.symbolSprites[t].getChildAt(1);u.killTweensOf(s.scale),s.scale.set(1)}}else for(let t=0;t<this.cardRevealed.length;t++)if(this.cardRevealed[t]){const e=this.symbolSprites[t].getChildAt(0);u.isTweening(e)&&(u.killTweensOf(e),e.alpha=1);const s=this.symbolSprites[t].getChildAt(1);u.isTweening(s)&&(u.killTweensOf(s),s.alpha=1)}}resume(){for(const t in this.sameCards)if(this.sameCards[t].length>(this.isScratched?2:1))for(let e=0;e<this.sameCards[t].length;e++){const s=this.symbolSprites[this.sameCards[t][e]].getChildAt(0),a=this.symbolSprites[this.sameCards[t][e]].getChildAt(1);this.isScratched?(s.autoUpdate=!0,s.state.setAnimation(0,"default",!0),Number(t)>0&&u.to(a.scale,{x:1.2,y:1.2,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"})):(u.to(s,{alpha:.3,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}),u.to(a,{alpha:.3,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}))}}}class it extends m{constructor(t){super();n(this,"messageBox",new S);n(this,"okButton");n(this,"headerText");n(this,"messageText");this.addChild(this.messageBox),this.headerText=new w(p().message,{...z,fontSize:30,letterSpacing:0}),this.headerText.anchor.set(.5),this.messageBox.addChild(this.headerText),this.okButton=new ae(()=>{l.dismissPopup()}),this.messageBox.addChild(this.okButton),this.messageText=new w(t,{...z,fontSize:30,wordWrap:!0,letterSpacing:0}),this.messageText.anchor.set(.5),this.messageBox.addChild(this.messageText)}resize(t,e){const s=t>800?800:t-50,a=e>600?600:e-50;this.headerText.x=s/2,this.headerText.y=50,this.messageBox.clear(),this.messageBox.beginFill(655397,.9),this.messageBox.drawRoundedRect(0,0,s,a,30),this.messageBox.endFill(),this.messageBox.x=t/2-s/2,this.messageBox.y=e/2-a/2,this.okButton.x=s/2,this.okButton.y=a-70,this.messageText.style.wordWrapWidth=s-100,this.messageText.x=s/2,this.messageText.y=a/2}async show(){l.currentScreen&&(l.currentScreen.filters=[new U(5)]),l.background&&(l.background.filters=[new U(5)]),u.killTweensOf(this.messageBox.pivot),this.messageBox.pivot.y=-400,u.to(this.messageBox.pivot,{y:0,duration:.3,ease:"back.out"})}async hide(){l.currentScreen&&(l.currentScreen.filters=null),l.background&&(l.background.filters=null),u.killTweensOf(this.messageBox.pivot),await u.to(this.messageBox.pivot,{y:-500,duration:.3,ease:"back.in"})}}class de extends m{constructor(){super();n(this,"title");n(this,"doneButton");n(this,"settingsButton");n(this,"historyData",[]);n(this,"spinner");n(this,"cardFrame");n(this,"cardLayer");n(this,"scratchPan");n(this,"buttonList");n(this,"pageIndex",0);n(this,"prevButton");n(this,"nextButton");n(this,"paginationSlider");n(this,"winAmountText");n(this,"dateText");n(this,"currency","");n(this,"totalPage",0);this.title=new w(p().settingsHistory.replace(/\n/g," "),{...R,fontSize:40}),this.title.anchor.set(.5),this.title.y=-420,this.addChild(this.title),this.cardFrame=new bt,this.cardFrame.visible=!1,this.cardFrame.scale.set(.6),this.cardFrame.y=-120,this.addChild(this.cardFrame),this.cardLayer=new m,this.cardFrame.addChild(this.cardLayer),this.prevButton=new gt(()=>this.onClickPrev(),!1),this.prevButton.x=-435,this.nextButton=new gt(()=>this.onClickNext()),this.nextButton.x=435,this.cardFrame.addChild(this.prevButton),this.cardFrame.addChild(this.nextButton);const t=new D({type:"vertical",elementsMargin:15});t.x=-400,t.y=555,this.cardFrame.addChild(t),this.winAmountText=new w(`${p().winAmount}:`,{...z,fontSize:40}),t.addChild(this.winAmountText),this.dateText=new w(`${p().date}:`,{...z,fontSize:40}),t.addChild(this.dateText),this.buttonList=new D({type:"horizontal",elementsMargin:25}),this.buttonList.y=420,this.buttonList.x=-140,this.addChild(this.buttonList),this.settingsButton=new E("green",()=>{var e,s;(s=(e=l==null?void 0:l.currentPopup)==null?void 0:e.gate)==null||s.call(e,"switchPanel")},p().settingsTitle,{fontSize:25}),this.settingsButton.y=120,this.buttonList.addChild(this.settingsButton),this.doneButton=new E("green",()=>{l.dismissPopup()},p().settingsDone,{fontSize:35}),this.doneButton.y=220,this.buttonList.addChild(this.doneButton),this.spinner=y.from("spinner"),this.spinner.anchor.set(.5),this.spinner.y=-110,this.addChild(this.spinner)}async getHistoryFromServer(){if(this.historyData.length>0)this.spinner.visible=!1,u.killTweensOf(this.spinner),this.showHistory();else{this.showLoadingSpinner();try{const t=await F.get(`${G}/${V}/history?page=${this.pageIndex+1}&per_page=1`);this.historyData=t.data.data.history,this.currency=t.data.data.currency,this.totalPage=t.data.meta.total,this.spinner.visible=!1,this.cardFrame.visible=!0,u.killTweensOf(this.spinner),this.paginationSlider=new le(this.totalPage,e=>{wt("pageUpdate",500,()=>{this.onPageSliderChange(e)})}),this.paginationSlider.y=485,this.paginationSlider.x=-400,this.cardFrame.addChild(this.paginationSlider),this.showHistory()}catch{this.hideLoadingSpinner(),l.presentPopup(it,p().wrong)}}}async showHistory(){var e;const t=this.historyData[0];(e=this.scratchPan)==null||e.removeFromParent(),this.scratchPan=new Q(t.cards),this.scratchPan.showResult(),this.updateText(),this.updatePrevNextButtonState(),this.cardLayer.addChild(this.scratchPan)}showLoadingSpinner(){this.spinner.visible=!0,u.killTweensOf(this.spinner),this.spinner.rotation=0,u.to(this.spinner,{rotation:Math.PI*2,repeat:-1,ease:"linear",duration:2})}hideLoadingSpinner(){this.spinner.visible=!1,u.killTweensOf(this.spinner)}async updateHistoryFromServer(){this.showLoadingSpinner();try{const t=await F.get(`${G}/${V}/history?page=${this.pageIndex+1}&per_page=1`);this.historyData=t.data.data.history,this.currency=t.data.data.currency,this.hideLoadingSpinner(),this.showHistory()}catch{this.hideLoadingSpinner(),l.presentPopup(it,p().wrong)}}async onClickNext(){this.pageIndex++,await this.updateHistoryFromServer(),this.paginationSlider.value=this.pageIndex+1}async onClickPrev(){this.pageIndex--,await this.updateHistoryFromServer(),this.paginationSlider.value=this.pageIndex+1}updateText(){const t=this.historyData[0];this.winAmountText.text=`${p().winAmount}: ${this.currency} ${Number(t.prize)}`,this.dateText.text=`${p().date}: ${new Date(t.timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})}`}updatePrevNextButtonState(){this.prevButton.enabled=this.pageIndex>0,this.nextButton.enabled=this.pageIndex<this.totalPage-1}onPageSliderChange(t){Math.round(t)-1!==this.pageIndex&&(this.pageIndex=Math.round(t)-1,this.updateHistoryFromServer())}}class ue extends m{constructor(){super();n(this,"bg");n(this,"settingPanel");n(this,"historyPanel");this.bg=y.from(W.WHITE),this.bg.tint=655397,this.bg.eventMode="static",this.addChild(this.bg),this.settingPanel=new ce,this.addChild(this.settingPanel),this.historyPanel=new de,this.historyPanel.visible=!1,this.addChild(this.historyPanel)}resize(t,e){if(this.bg.width=t,this.bg.height=e,this.settingPanel.x=t*.5,this.settingPanel.y=e*.5,this.historyPanel.x=t*.5,this.historyPanel.y=e*.5,A()){const s=Nt,a=Gt,h=window.innerWidth<s?s/window.innerWidth:1,g=window.innerHeight<a?a/window.innerHeight:1,c=h>g?h:g;this.settingPanel.scale.set(c)}}async show(){l.currentScreen&&(l.currentScreen.filters=[new U(5)]),l.background&&(l.background.filters=[new U(5)]),u.killTweensOf(this.bg),u.killTweensOf(this.settingPanel.pivot),this.bg.alpha=0,this.settingPanel.pivot.y=-400,u.to(this.bg,{alpha:.8,duration:.2,ease:"linear"}),await u.to(this.settingPanel.pivot,{y:0,duration:.3,ease:"back.out"})}async hide(){l.currentScreen&&(l.currentScreen.filters=null),l.background&&(l.background.filters=null),u.killTweensOf(this.bg),u.killTweensOf(this.settingPanel.pivot),u.to(this.bg,{alpha:0,duration:.2,ease:"linear",delay:.3}),await u.to(this.settingPanel.pivot,{y:-500,duration:.3,ease:"back.in"})}gate(t){switch(t){case"switchPanel":this.settingPanel.visible=!this.settingPanel.visible,this.historyPanel.visible=!this.settingPanel.visible,this.historyPanel.visible&&this.historyPanel.getHistoryFromServer();break}}}class pe extends m{constructor(){super();n(this,"settingButton");n(this,"sfxButton");n(this,"bgmButton");this.settingButton=new ne(()=>{l.presentPopup(ue)}),this.sfxButton=new pt("sfx"),this.bgmButton=new pt("bgm"),this.addChild(this.settingButton),this.sfxButton.x=120,this.addChild(this.sfxButton),this.bgmButton.x=240,this.addChild(this.bgmButton)}updateAudioBtn(t){t==="sfx"?this.sfxButton.updateState():this.bgmButton.updateState()}}class ge extends m{constructor(t){super();n(this,"graphics",new S);n(this,"credit");n(this,"totalWin");n(this,"win");this.graphics.lineStyle(4,14803425,1),this.graphics.beginFill(1261982,.75),this.graphics.drawRect(0,0,1928,119),this.graphics.endFill(),this.addChild(this.graphics),this.credit=new w(p().credit+`
`+O()+" "+N(t),z),this.credit.anchor.set(0),this.addChild(this.credit),this.totalWin=new w(p().totalWin,z),this.totalWin.anchor.set(.5,0),this.totalWin.visible=!1,this.addChild(this.totalWin),this.win=new w(p().win,z),this.win.anchor.set(1,0),this.win.visible=!1,this.addChild(this.win)}resize(t,e){this.x=-4,A()?(this.y=e-90,this.totalWin.x=t*.5,this.totalWin.y=25,this.credit.x=t*.5-290,this.credit.y=10,this.win.x=t*.5+295,this.win.y=10,this.totalWin.y=10,this.credit.style.fontSize=28):(this.y=e-115,this.credit.x=250,this.credit.y=6,this.win.x=t-250,this.win.y=6,this.totalWin.y=6,this.credit.style.fontSize=45),this.totalWin.x=t*.5}setValue(t,e,s){this.credit.text=p().credit+`
`+O()+" "+N(t),e===0?this.win.visible=!1:(this.win.visible=!0,this.win.text=p().win+`
`+O()+" "+N(e)),s===0?this.totalWin.visible=!1:(this.totalWin.visible=!0,this.totalWin.text=p().totalWin+`
`+O()+" "+N(s))}}class fe extends m{constructor(){super();n(this,"tickets");n(this,"darkBackground");n(this,"backgroundSprite");n(this,"cardLeftText");n(this,"textGroup");this.darkBackground=new S,this.darkBackground.beginFill(0,.5),this.darkBackground.drawRect(-540,-25,1080,50),this.darkBackground.endFill(),this.addChild(this.darkBackground),this.backgroundSprite=y.from("cards_left"),this.backgroundSprite.anchor.set(.5),this.addChild(this.backgroundSprite),this.textGroup=new D({type:"vertical",elementsMargin:30}),this.addChild(this.textGroup),this.tickets=new rt(String(r.currentState.ticketsLeft),{fontName:"golden_number",letterSpacing:0,align:"center"}),this.tickets.anchor.set(.5),this.textGroup.addChild(this.tickets),this.cardLeftText=new w(p().ticketsLeftMobile,{...Z,fontSize:33,strokeThickness:3}),this.cardLeftText.anchor.set(.5),this.textGroup.addChild(this.cardLeftText)}resize(t,e){t<e?(this.backgroundSprite.visible=!1,this.darkBackground.visible=!0,this.cardLeftText.text=p().ticketsLeftMobile,this.cardLeftText.style={...Z,fontSize:33,strokeThickness:3},this.cardLeftText.anchor.set(0,.5),this.tickets.fontSize=30,this.tickets.anchor.set(.5),this.textGroup.type="horizontal",this.textGroup.elementsMargin=15,this.textGroup.x=-(this.textGroup.width/2)+15,this.textGroup.y=0):(this.backgroundSprite.visible=!0,this.darkBackground.visible=!1,this.cardLeftText.text=p().ticketsLeft,this.cardLeftText.style=Z,this.cardLeftText.anchor.set(.5),this.tickets.fontSize=80,this.tickets.anchor.set(.5),this.textGroup.type="vertical",this.textGroup.elementsMargin=30,this.textGroup.x=0,this.textGroup.y=-50)}setNumber(t,e=!1){t<0||(this.tickets.text=String(t),e&&(u.killTweensOf(this.tickets.scale),u.to(this.tickets.scale,{x:1.3,y:1.3,repeat:1,duration:.2,yoyo:!0,ease:"sine.inOut"})))}}class me extends m{constructor(){super();const i=y.from("freeplay");i.anchor.set(.5),this.addChild(i);const t=new w(p().freeplayCapital,{...Z,fontSize:40});if(t.anchor.set(.5),t.width>270){const e=t.width/t.height;t.width=250,t.height=250/e}this.addChild(t)}}class ye extends m{constructor(){super();n(this,"bg");n(this,"coinContainer",new m);n(this,"coinTextures",[]);n(this,"timer",0);n(this,"coinCount",0);n(this,"fallingSpeed",20);n(this,"screenWidth",0);n(this,"youWonSpine");n(this,"moneyString");n(this,"clickToContinue");this.bg=y.from(W.WHITE),this.bg.tint=655397,this.addChild(this.bg),this.addChild(this.coinContainer);let t;for(t=0;t<10;t++){const a=W.from(`coin${t}`);this.coinTextures.push(a)}const e=r.currentState.language===H.Portuguese?r.currentState.language:H.English,s=T.cache.get(`home/spine/cst_won_${e}_anim.json`);this.youWonSpine=new j(s.spineData),this.youWonSpine.autoUpdate=!0,this.youWonSpine.state.setAnimation(0,"default",!0),this.addChild(this.youWonSpine),this.moneyString=new rt(O()+r.currentState.totalWin,{fontName:"impact_night",fontSize:50,align:"center"}),this.moneyString.anchor.set(.5),this.addChild(this.moneyString),u.killTweensOf(this.moneyString.scale),u.to(this.moneyString.scale,{x:1.3,y:1.3,yoyo:!0,repeat:-1,ease:"sine.inOut",duration:.5}),this.clickToContinue=new w(p().clickToContinue,St),this.clickToContinue.anchor.set(.5),this.addChild(this.clickToContinue),this.eventMode="static",this.on("pointerdown",()=>{l.dismissPopup()})}resize(t,e){this.bg.width=t,this.bg.height=e,this.youWonSpine.x=t*.5,this.youWonSpine.y=e*.5-250,this.moneyString.x=t*.5,this.moneyString.y=e*.5,this.clickToContinue.x=t*.5,this.clickToContinue.y=e*.5+200,this.screenWidth=t,t<e?(this.coinCount=5,this.youWonSpine.scale.set(.8),this.moneyString.fontSize=60,this.fallingSpeed=20,this.clickToContinue.style.fontSize=25):(this.coinCount=8,this.youWonSpine.scale.set(1),this.moneyString.fontSize=80,this.fallingSpeed=30,this.clickToContinue.style.fontSize=30),this.coinContainer.removeChildren(),this.timer=0,this.generateCoins(t,!1),this.generateCoins(t)}update(t){let e;if(this.timer>60)for(this.timer=0,this.generateCoins(this.screenWidth),e=0;e<this.coinContainer.children.length;e++)this.coinContainer.children[e].y>b&&this.coinContainer.children[e].removeFromParent();for(e=0;e<this.coinContainer.children.length;e++)this.coinContainer.children[e].y+=Math.floor(Math.random()*this.fallingSpeed)+1;this.timer+=t}generateCoins(t,e=!0){let s;for(s=0;s<this.coinCount;s++){const a=new Rt(this.coinTextures);a.x=Math.random()*t,a.y=e?Math.random()*b-b:Math.random()*b,a.anchor.set(.5),a.rotation=Math.random()*Math.PI,a.scale.set(.5+Math.random()*.5),a.animationSpeed=.2,a.gotoAndPlay(Math.random()*10|0),this.coinContainer.addChild(a)}}async show(){l.currentScreen&&(l.currentScreen.filters=[new U(5)]),l.background&&(l.background.filters=[new U(5)]),I.play("home/sfx-celebration.ogg"),u.killTweensOf(this.bg),this.bg.alpha=0,u.to(this.bg,{alpha:.8,duration:.3,ease:"linear"})}async hide(){l.currentScreen&&(l.currentScreen.filters=null),l.background&&(l.background.filters=null),I.play("home/bgm.mp3"),this.coinContainer.removeChildren(),u.killTweensOf(this.bg),u.to(this.bg,{alpha:0,duration:.2,ease:"linear",delay:.3})}}class Ct extends m{constructor(){super();n(this,"bottomContainer");n(this,"cardFrame");n(this,"paytableButton");n(this,"buyNowButton");n(this,"scratchButton");n(this,"autoplayButton");n(this,"buyTicketContainer");n(this,"paytableContainer");n(this,"loadingContainer");n(this,"settingAudioContainer");n(this,"cardsLeftContainer");n(this,"scratchPan");n(this,"prevFrameContent","buyNow");n(this,"timeout");this.paytableButton=new E("blue",()=>{this.showPaytable(!0)},p().paytable,{fontSize:33}),this.addChild(this.paytableButton),this.scratchButton=new E("yellow",()=>{this.scratch()},p().scratch,{fontSize:40}),this.scratchButton.enabled=!1,this.scratchButton.alpha=.6,this.addChild(this.scratchButton),this.autoplayButton=new E("green",()=>{this.autoPlay()},p().autoplay,{fontSize:33}),this.autoplayButton.enabled=!1,this.autoplayButton.alpha=.6,this.addChild(this.autoplayButton),this.cardFrame=new bt,this.addChild(this.cardFrame),this.buyTicketContainer=new re(t=>{r.setGameState({buyTickets:Number(t.val.split(" ")[0])})}),this.buyNowButton=new E("green",()=>{this.startGame()},p().buyNow,{fontSize:33}),this.buyNowButton.y=300,this.buyTicketContainer.addChild(this.buyNowButton),this.cardFrame.addChild(this.buyTicketContainer),this.paytableContainer=new oe(()=>{this.showPaytable(!1)}),this.paytableContainer.visible=!1,this.cardFrame.addChild(this.paytableContainer),this.loadingContainer=new he,this.loadingContainer.visible=!1,this.cardFrame.addChild(this.loadingContainer),this.cardsLeftContainer=new fe,this.cardsLeftContainer.visible=!1,this.addChild(this.cardsLeftContainer),this.settingAudioContainer=new pe,this.addChild(this.settingAudioContainer),this.bottomContainer=new ge(r.currentState.credit),this.addChild(this.bottomContainer),this.alpha=0}resize(t,e){A()?(this.cardFrame.x=t*.5,this.cardFrame.y=e*.5-90,this.cardFrame.scale.set(.67),this.settingAudioContainer.x=t*.5-250,this.settingAudioContainer.y=40,this.settingAudioContainer.scale.set(.6),this.cardsLeftContainer.x=t*.5,this.cardsLeftContainer.y=e*.5+239,this.paytableButton.x=t*.5+200,this.paytableButton.scale.set(.8),r.currentState.isGameStarted?(this.scratchButton.y=860,this.autoplayButton.y=945,this.paytableButton.y=945):(this.scratchButton.y=830,this.autoplayButton.y=925,this.paytableButton.y=925),this.autoplayButton.x=t*.5-200,this.autoplayButton.scale.set(.8),this.scratchButton.x=t*.5,this.scratchButton.scale.set(.8),this.buyNowButton.scale.set(1.3)):(this.cardFrame.x=t*.5,this.cardFrame.y=e*.5-60,this.cardFrame.scale.set(1),this.settingAudioContainer.scale.set(1),this.settingAudioContainer.x=t-330,this.settingAudioContainer.y=100,this.paytableButton.x=250,this.paytableButton.y=860,this.paytableButton.scale.set(1.2),this.autoplayButton.x=t-250,this.autoplayButton.y=860,this.autoplayButton.scale.set(1.2),this.scratchButton.x=t-250,this.scratchButton.y=700,this.scratchButton.scale.set(1.2),this.cardsLeftContainer.x=1670,this.cardsLeftContainer.y=400,this.buyNowButton.scale.set(1)),this.bottomContainer.resize(t,e),this.cardsLeftContainer.resize(t,e)}async show(){I.play("home/bgm.mp3"),u.killTweensOf(this),await u.to(this,{alpha:1,duration:.6,ease:"linear"}),r.currentState.ticketsLeft>0&&this.resumeGame()}async prepare(){u.killTweensOf(this.buyNowButton.scale),u.to(this.buyNowButton.scale,{x:1.2,y:1.2,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"})}async hide(){u.killTweensOf(this),await u.to(this,{alpha:0,duration:.6,ease:"linear"})}pause(){var t,e,s,a;(e=(t=l==null?void 0:l.background)==null?void 0:t.pause)==null||e.call(t),(s=this.scratchPan)!=null&&s.visible&&((a=this.scratchPan)==null||a.pause()),u.killTweensOf(this.buyNowButton.scale),this.buyNowButton.scale.set(1)}resume(){var t,e,s,a;(e=(t=l==null?void 0:l.background)==null?void 0:t.resume)==null||e.call(t),(s=this.scratchPan)!=null&&s.visible&&((a=this.scratchPan)==null||a.resume()),this.prepare()}showPaytable(t){t?(this.buyTicketContainer.visible=!1,this.scratchPan&&(this.scratchPan.visible=!1)):this.prevFrameContent==="buyNow"?this.buyTicketContainer.visible=!0:this.prevFrameContent==="scratchPan"&&(this.scratchPan.visible=!0),this.paytableContainer.visible=t}async startGame(){var s;const t=r.currentState.buyTickets===25?5:r.currentState.buyTickets===50?10:0,e=r.currentState.buyTickets*r.currentState.ticketPrice-r.currentState.buyTickets*r.currentState.ticketPrice*t/100;if(r.currentState.credit>=e){this.eventMode="none",this.showLoading(!0);try{const a=await F.post(`${G}/${V}/tickets`,{tickets:r.currentState.buyTickets}),{balance:h,ticketsLeft:g}=a.data;r.setGameState({isGameStarted:!0,credit:h,ticketsLeft:g});const c=await F.post(`${G}/${V}/play`);if(r.setGameState({roundResult:{...c.data}}),this.prevFrameContent="scratchPan",this.setButtonEnabled(this.scratchButton,!0),this.setButtonEnabled(this.autoplayButton,!0),this.scratchPan=new Q(r.currentState.roundResult.cards),this.cardFrame.addChild(this.scratchPan),this.cardsLeftContainer.setNumber(g),this.bottomContainer.setValue(h,0,0),this.scratchButton.changeLabel(p().scratch),A()){const d=window.innerHeight/window.innerWidth,f=_/b;d>f?this.paytableButton.x=b/f/2+200:this.paytableButton.x=b/d/2+200,this.scratchButton.y=860,this.autoplayButton.y=945,this.paytableButton.y=945}this.cardsLeftContainer.visible=!0,this.showLoading(!1),this.eventMode="static"}catch(a){F.isAxiosError(a)?this.onRequestErrorHandler((s=a.response)==null?void 0:s.data.message):this.onRequestErrorHandler(p().wrong)}}else l.presentPopup(it,p().insufficientBalance)}async resumeGame(){var t;this.eventMode="none",this.showLoading(!0);try{const e=await F.post(`${G}/${V}/play`);if(r.setGameState({isGameStarted:!0,roundResult:{...e.data}}),this.prevFrameContent="scratchPan",this.setButtonEnabled(this.scratchButton,!0),this.setButtonEnabled(this.autoplayButton,!0),this.scratchPan=new Q(r.currentState.roundResult.cards),this.cardFrame.addChild(this.scratchPan),this.cardsLeftContainer.setNumber(r.currentState.ticketsLeft),this.scratchButton.changeLabel(p().scratch),A()){const s=window.innerHeight/window.innerWidth,a=_/b;s>a?this.paytableButton.x=b/a/2+200:this.paytableButton.x=b/s/2+200,this.scratchButton.y=860,this.autoplayButton.y=945,this.paytableButton.y=945}this.cardsLeftContainer.visible=!0,this.showLoading(!1),this.eventMode="static"}catch(e){F.isAxiosError(e)?this.onRequestErrorHandler((t=e.response)==null?void 0:t.data.message):this.onRequestErrorHandler(p().wrong)}}scratch(){var t;r.currentState.ticketsLeft>0?r.currentState.isScratched?this.nextRound():(this.paytableButton.visible&&this.showPaytable(!1),r.currentState.isScratched||(t=this.scratchPan)==null||t.reveal()):this.finishGame()}gate(t,e){switch(t){case"updateSFXButton":this.settingAudioContainer.updateAudioBtn("sfx");break;case"updateBGMButton":this.settingAudioContainer.updateAudioBtn("bgm");break;case"finishRound":this.finishRound(e);break}}finishRound(t){r.currentState.ticketsLeft=r.currentState.roundResult.ticketsLeft,this.cardsLeftContainer.setNumber(r.currentState.ticketsLeft),r.currentState.isScratched=!0;let e=1e3;if(t.length>0){e=3e3;let s=r.currentState.totalWin+r.currentState.roundResult.prize,a=Number(r.currentState.roundResult.prize),h=r.currentState.roundResult.balance;for(let g=0;g<t.length;g++)t[g]===0&&(r.currentState.ticketsLeft=r.currentState.ticketsLeft+1,this.freeplayAnimation());r.setGameState({win:a,totalWin:s,credit:h}),a>=100?x.play("home/sfx-bigwin.ogg"):a>=10?x.play("home/sfx-mediumwin.ogg"):a>0?x.play("home/sfx-smallwin.ogg"):x.play("home/sfx-freeplay.ogg"),this.bottomContainer.setValue(h,a,s)}r.currentState.ticketsLeft>0?(this.scratchButton.changeLabel(p().playNext),r.currentState.isAutoPlay&&(this.timeout=setTimeout(()=>this.nextRound(),e))):(this.scratchButton.changeLabel(p().buyMoreTickets),r.currentState.isAutoPlay&&this.autoPlay(),this.setButtonEnabled(this.autoplayButton,!1),r.currentState.totalWin>0?l.presentPopup(ye):x.play("home/sfx-fail.ogg"))}async nextRound(){var t,e;r.currentState.isAutoPlay||clearTimeout(this.timeout),this.showLoading(!0),this.setAllButtonState(!1);try{const s=await F.post(`${G}/${V}/play`);r.setGameState({roundResult:{...s.data}}),(t=this.scratchPan)==null||t.removeFromParent(),this.scratchPan=new Q(s.data.cards),r.currentState.isAutoPlay&&(this.scratchPan.eventMode="none"),this.cardFrame.addChild(this.scratchPan),this.scratchButton.changeLabel(p().scratch),r.currentState.isScratched=!1,this.bottomContainer.setValue(r.currentState.credit,0,r.currentState.totalWin),r.currentState.isAutoPlay&&(r.currentState.ticketsLeft>0?setTimeout(()=>this.scratch(),500):r.currentState.isAutoPlay=!1),this.showLoading(!1),this.setAllButtonState(!0)}catch(s){F.isAxiosError(s)?this.onRequestErrorHandler((e=s.response)==null?void 0:e.data.message):this.onRequestErrorHandler(p().wrong)}}autoPlay(){if(r.currentState.isAutoPlay=!r.currentState.isAutoPlay,r.currentState.isAutoPlay){if(r.currentState.ticketsLeft===0)return;this.scratchButton.visible=!1,this.setButtonEnabled(this.paytableButton,!1),this.autoplayButton.changeLabel(p().stop),this.scratch()}else this.scratchButton.visible=!0,this.setButtonEnabled(this.paytableButton,!0),clearTimeout(this.timeout),this.autoplayButton.changeLabel(p().autoplay)}finishGame(){var t;r.setGameState({isGameStarted:!1,totalWin:0,win:0,isScratched:!1,isAutoPlay:!1}),this.prevFrameContent="buyNow",this.buyTicketContainer.visible=!0,this.paytableContainer.visible=!1,this.scratchButton.enabled=!1,this.scratchButton.alpha=.6,this.scratchButton.changeLabel(p().scratch),(t=this.scratchPan)==null||t.removeFromParent(),this.cardsLeftContainer.visible=!1,this.bottomContainer.setValue(r.currentState.credit,0,0),A()&&(this.scratchButton.y=830,this.autoplayButton.y=925,this.paytableButton.y=925)}async freeplayAnimation(){this.setButtonEnabled(this.scratchButton,!1),this.setButtonEnabled(this.autoplayButton,!1);const t=new me;if(t.alpha=0,t.scale.set(.2),A()){const e=window.innerHeight/window.innerWidth,s=_/b;e>s?t.x=b/s/2:t.x=b/e/2}else t.x=960;t.y=540,this.addChild(t),u.killTweensOf(t),u.to(t,{alpha:1,rotation:Math.PI*2,width:270,height:270,ease:"sine.in",duration:.5}),await u.to(t,{x:A()?this.cardsLeftContainer.x-190:this.cardsLeftContainer.x,y:A()?this.cardsLeftContainer.y:this.cardsLeftContainer.y-50,width:5,height:5,ease:"sine.in",duration:.5,delay:1}),this.cardsLeftContainer.setNumber(r.currentState.ticketsLeft,!0),t.removeFromParent(),this.setButtonEnabled(this.scratchButton,!0),this.setButtonEnabled(this.autoplayButton,!0)}setButtonEnabled(t,e){t.enabled=e,t.alpha=e?1:.6}showLoading(t){t?(this.paytableContainer.visible=!1,this.buyTicketContainer.visible=!1,this.scratchPan&&(this.scratchPan.visible=!1),this.loadingContainer.show()):(this.prevFrameContent==="buyNow"&&(this.buyTicketContainer.visible=!0),this.loadingContainer.hide()),this.loadingContainer.visible=t}onRequestErrorHandler(t){l.presentPopup(it,t),this.showLoading(!1),this.eventMode="static"}setAllButtonState(t){this.setButtonEnabled(this.scratchButton,t),this.setButtonEnabled(this.autoplayButton,t),this.setButtonEnabled(this.paytableButton,t)}}n(Ct,"assetBundles",["home"]);class Bt extends m{constructor(){super();n(this,"loading");n(this,"companyLogo");n(this,"progressBar");n(this,"progressBarBg");n(this,"progressBarFill");n(this,"onProgress",t=>{this.progressBar.progress=t*100});this.loading=new m,this.addChild(this.loading),this.companyLogo=new te,this.companyLogo.y=-40,this.loading.addChild(this.companyLogo),this.progressBarBg=new S,this.progressBarBg.beginFill(3355443),this.progressBarBg.drawRoundedRect(0,0,300,10,5),this.progressBarBg.endFill(),this.progressBarFill=new S,this.progressBarFill.beginFill(14561865),this.progressBarFill.drawRoundedRect(0,0,300,10,5),this.progressBarFill.endFill(),this.progressBar=new Et({bg:this.progressBarBg,fill:this.progressBarFill,progress:0}),this.progressBar.y=40,this.progressBar.x=-150,this.loading.addChild(this.progressBar),this.loading.alpha=0}resize(t,e){this.loading.x=t*.5,this.loading.y=e*.5}async show(){u.killTweensOf(this.loading),await u.to(this.loading,{alpha:1,duration:1,ease:"linear"});const t=qt();await ot(t,this.onProgress),l.setBackground(se),l.showScreen(Ct)}async hide(){u.killTweensOf(this.loading),await u.to(this.loading,{alpha:0,duration:1,ease:"linear"})}}n(Bt,"assetBundles",["preload"]);const B=new zt({resolution:window.devicePixelRatio,backgroundColor:Ot,width:_,height:b});function mt(){const o=window.innerWidth,i=window.innerHeight;let t=o/i,e,s;const a=_/b;o>i?(t>a?(e=i*a,s=i):(e=o,s=o/a),B.renderer.resize(_,b),l.resize(_,b)):(t=i/o,t>a?(e=o,s=o*a,B.renderer.resize(b/a,b),l.resize(b/a,b)):(e=o,s=i,B.renderer.resize(b/t,b),l.resize(b/t,b))),B.renderer.view.style.width=`${e}px`,B.renderer.view.style.height=`${s}px`,window.scrollTo(0,0)}function be(){document.hidden?(tt.pauseAll(),l.blur()):(tt.resumeAll(),l.focus())}async function we(){await Se()?(document.body.appendChild(B.view),window.addEventListener("resize",mt),mt(),document.addEventListener("visibilitychange",be),await Yt(),await l.showScreen(Bt)):document.write("Server Error!")}async function Se(){try{const o=await F.get(`${G}/${V}/info`);return r.setGameState({credit:o.data.balance,currency:o.data.currency,ticketPrice:o.data.ticketPrice,ticketsLeft:o.data.ticketsLeft,ticketPool:o.data.ticketPool,prizes:o.data.prizes}),!0}catch(o){return console.error(o),!1}}we();
