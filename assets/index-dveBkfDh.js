var Tt=Object.defineProperty;var Pt=(r,i,t)=>i in r?Tt(r,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[i]=t;var n=(r,i,t)=>(Pt(r,typeof i!="symbol"?i+"":i,t),t);import{n as et,o as F,C as m,b as y,q as Y,t as w,G as S,u as q,T as I,v as Lt,w as Ft,x as D,y as bt,z as rt,H as At,R as Mt,j as $,I as Rt,J as Et,K as zt}from"./@pixi-DoOeBslk.js";import"./pixi.js-CnUX8r_4.js";import"./eventemitter3-Bav5T-Ru.js";import"./earcut-DOWYkTK5.js";import"./url-J8SwAPIS.js";import{a as G}from"./axios-Cm0UX6qg.js";import{g as u}from"./gsap-ZORhgBxb.js";import{S as U}from"./@pixi-spine-1RzxFvll.js";import"./typed-signals-Bqx_1MKE.js";import"./tweedle.js-CzjNpvYT.js";import"./ismobilejs-CHLuctl-.js";import"./call-bind-CkPzBTRv.js";import"./get-intrinsic-B1Ut8WxJ.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-B8G-TZ45.js";import"./hasown-B9bXSDSU.js";import"./set-function-length-Ct5B6P4y.js";import"./define-data-property-CUxyvwXF.js";import"./es-define-property-28jGrh5V.js";import"./gopd-O61WwtTx.js";import"./has-property-descriptors-Cvfij9iw.js";import"./side-channel-CzTPmnEc.js";import"./object-inspect-CJVVCa5F.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();const j="https://5748-scratchcards-api-piec-zam-393.ggworld.work/api/v1/scratchcards",X="scratch-cards-test-game",W=1920,b=1080,Ot=0,Nt=320,Gt=582.5,K="volume-bgm",ct="volume-bgm-prev",J="volume-sfx",dt="volume-sfx-prev",Z=4,Vt=65,B=830,H=[1,5,10,25,50],It="BRL",ut={language:"lang",currency:"cur"},Wt={BRL:"R$",USD:"$",EUR:"€",GBP:"£",JPY:"¥",KRW:"₩",NGN:"₦",PHP:"₱",RUB:"₽",THB:"฿",CRC:"₡",INR:"₹",TRY:"₺"},_={Portuguese:"pt",English:"en",Spanish:"sp",French:"fr"};class _t{constructor(){n(this,"currentAlias");n(this,"current");n(this,"volume",1)}async play(i,t){if(this.currentAlias!==i){if(this.current){const e=this.current;u.killTweensOf(e),u.to(e,{volume:0,duration:1,ease:"linear"}).then(()=>{e.stop()})}this.current=et.find(i),this.currentAlias=i,this.current.play({loop:!0,...t}),this.current.volume=0,u.killTweensOf(this.current),u.to(this.current,{volume:this.volume,duration:1,ease:"linear"})}}getVolume(){return this.volume}setVolume(i){this.volume=i,this.current&&(this.current.volume=this.volume)}}class Ht{constructor(){n(this,"volume",1)}play(i,t){const e=this.volume*((t==null?void 0:t.volume)??1);et.play(i,{...t,volume:e})}getVolume(){return this.volume}setVolume(i){this.volume=i}}const V=new _t,x=new Ht;class Dt{getString(i){return localStorage.getItem(i)??void 0}setString(i,t){localStorage.setItem(i,t)}getNumber(i){const t=this.getString(i)??void 0,e=Number(t);return isNaN(e)?null:e}setNumber(i,t){this.setString(i,String(t))}getBool(i){const t=localStorage.getItem(i);return t?!!t.toLowerCase():void 0}setBool(i,t){localStorage.setItem(i,String(t))}getObject(i){const t=this.getString(i);if(t)try{return JSON.parse(t)}catch(e){console.warn(e);return}}setObject(i,t){this.setString(i,JSON.stringify(t))}}const L=new Dt;function pt(r){const i=window.location.search;return new URLSearchParams(i).get(r)}class $t{constructor(){n(this,"state",{ticketPrice:0,ticketPool:0,prizes:[],roundResult:{ticketsLeft:0,cards:[],prize:0,balance:0,currency:""},isGameStarted:!1,isScratched:!1,buyTickets:1,ticketsLeft:0,nextCards:[],credit:1e3,totalWin:0,win:0,isAutoPlay:!1,isMuteSFX:!0,isMuteBGM:!0,language:pt(ut.language)||_.Portuguese,currency:pt(ut.currency)||It});V.setVolume(0),x.setVolume(0)}getBgmVolume(){return L.getNumber(K)??0}setBgmVolume(i){i<=0?this.state.isMuteBGM=!0:this.state.isMuteBGM=!1,V.setVolume(i),L.setNumber(K,i),L.setNumber(ct,i)}muteBGM(){V.setVolume(0),L.setNumber(K,0)}unMuteBGM(){let i=L.getNumber(ct)??.5;i<=0&&(i=.5),V.setVolume(i),L.setNumber(K,i)}getSfxVolume(){return L.getNumber(J)??0}setSfxVolume(i){i<=0?this.state.isMuteSFX=!0:this.state.isMuteSFX=!1,x.setVolume(i),L.setNumber(J,i),L.setNumber(dt,i)}muteSFX(){x.setVolume(0),L.setNumber(J,0)}unMuteSFX(){let i=L.getNumber(dt)??.5;i<=0&&(i=.5),x.setVolume(i),L.setNumber(J,i)}get currentState(){return this.state}setGameState(i){this.state={...this.state,...i}}}const o=new $t;let it={bundles:[]};const at=[];function Ut(r){return!!it.bundles.find(i=>i.name===r)}async function ot(r,i=null){typeof r=="string"&&(r=[r]);for(const e of r)if(!Ut(e))throw new Error(`[Assets] Invalid bundle: ${e}`);const t=r.filter(e=>!at.includes(e));t.length&&(console.log("[Assets] Load:",t.join(", ")),i?await F.loadBundle(t,i):await F.loadBundle(t),at.push(...t))}function jt(r){for(const i of r)if(!at.includes(i))return!1;return!0}async function Xt(r){const t=await(await fetch(r)).json();if(!t.bundles)throw new Error("[Assets] Invalid assets manifest");return t}async function Yt(){it=await Xt("assets/assets-manifest.json"),await F.init({manifest:it,basePath:"assets"});try{await F.load(`i18n/${o.currentState.language}.json`)}catch{o.currentState.language=_.English,await F.load(`i18n/${o.currentState.language}.json`)}await ot("preload")}function qt(){return it.bundles.filter(r=>r.name!=="default").map(r=>r.name)}class Kt{constructor(i){n(this,"ctor");n(this,"list",[]);this.ctor=i}get(){return this.list.pop()??new this.ctor}giveBack(i){this.list.includes(i)||this.list.push(i)}}class Jt{constructor(){n(this,"map",new Map)}get(i){let t=this.map.get(i);return t||(t=new Kt(i),this.map.set(i,t)),t.get()}giveBack(i){const t=this.map.get(i.constructor);t&&t.giveBack(i)}}const Zt=new Jt;class Qt{constructor(){n(this,"container",new m);n(this,"width",0);n(this,"height",0);n(this,"background");n(this,"currentScreen");n(this,"currentPopup")}setBackground(i){this.background=new i,this.addAndShowScreen(this.background)}async addAndShowScreen(i){this.container.parent||k.stage.addChild(this.container),this.container.addChild(i),i.prepare&&i.prepare(),i.resize&&i.resize(this.width,this.height),i.update&&k.ticker.add(i.update,i),i.show&&(i.interactiveChildren=!1,await i.show(),i.interactiveChildren=!0)}async hideAndRemoveScreen(i){i.interactiveChildren=!1,i.hide&&await i.hide(),i.update&&k.ticker.remove(i.update,i),i.parent&&i.parent.removeChild(i),i.reset&&i.reset()}async showScreen(i){this.currentScreen&&(this.currentScreen.interactiveChildren=!1),i.assetBundles&&!jt(i.assetBundles)&&await ot(i.assetBundles),this.currentScreen&&await this.hideAndRemoveScreen(this.currentScreen),this.currentScreen=Zt.get(i),await this.addAndShowScreen(this.currentScreen)}resize(i,t){var e,s,a,l,g,d;this.width=i,this.height=t,(s=(e=this.currentScreen)==null?void 0:e.resize)==null||s.call(e,i,t),(l=(a=this.currentPopup)==null?void 0:a.resize)==null||l.call(a,i,t),(d=(g=this.background)==null?void 0:g.resize)==null||d.call(g,i,t)}async presentPopup(i,t=null){var e,s;this.currentScreen&&(this.currentScreen.interactiveChildren=!1,await((s=(e=this.currentScreen).pause)==null?void 0:s.call(e))),this.currentPopup&&await this.hideAndRemoveScreen(this.currentPopup),t?this.currentPopup=new i(t):this.currentPopup=new i,await this.addAndShowScreen(this.currentPopup)}async dismissPopup(){var t,e;if(!this.currentPopup)return;const i=this.currentPopup;this.currentPopup=void 0,await this.hideAndRemoveScreen(i),this.currentScreen&&(this.currentScreen.interactiveChildren=!0,(e=(t=this.currentScreen).resume)==null||e.call(t))}blur(){var i,t,e,s,a,l;(t=(i=this.currentScreen)==null?void 0:i.blur)==null||t.call(i),(s=(e=this.currentPopup)==null?void 0:e.blur)==null||s.call(e),(l=(a=this.background)==null?void 0:a.blur)==null||l.call(a)}focus(){var i,t,e,s,a,l;(t=(i=this.currentScreen)==null?void 0:i.focus)==null||t.call(i),(s=(e=this.currentPopup)==null?void 0:e.focus)==null||s.call(e),(l=(a=this.background)==null?void 0:a.focus)==null||l.call(a)}}const c=new Qt;class te extends m{constructor(){super();n(this,"image");this.image=y.from("preload/logo.png"),this.image.anchor.set(.5),this.addChild(this.image)}}class wt extends m{constructor(){super();n(this,"image");this.image=y.from("frame"),this.image.anchor.set(.5),this.addChild(this.image)}}Math.min(window.screen.width,window.screen.height)<768||navigator.userAgent.indexOf("Mobi")>-1;const p=()=>F.get(`i18n/${o.currentState.language}.json`)??F.get(`i18n/${_.English}.json`),E=()=>Wt[o.currentState.currency]||o.currentState.currency;function A(){return window.innerWidth<window.innerHeight}function z(r,i=!0){const t=r.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return i?t:t.split(".")[0]}const nt={};function St(r,i,t){nt[r]||(t(),nt[r]=setTimeout(()=>delete nt[r],i))}const O=new Y({fontFamily:"NotoSans Black",fontSize:30,fill:["#f9ffc9","#e0cb1c"],dropShadow:!0,dropShadowColor:"#000000",dropShadowAlpha:.5,dropShadowBlur:0,dropShadowAngle:Math.PI/2,dropShadowDistance:4,align:"center",lineJoin:"round"}),ht=new Y({fontFamily:"NotoSans Black",lineHeight:38,fill:["#ffffff","#fffcca"],stroke:"#691201",strokeThickness:4,align:"center",lineJoin:"round"}),ee={...ht,fill:["#ffffff","#cff7ff"],stroke:"#072f6a"},ie={...ht,stroke:"#0b3b00"},xt=new Y({dropShadow:!0,dropShadowColor:"#020454",dropShadowBlur:2,dropShadowDistance:4,fill:"#ffffff",fontFamily:"NotoSans Black",fontSize:30,lineJoin:"round",stroke:"#2b93d7",align:"center",strokeThickness:4}),R=new Y({fontFamily:"NotoSans Black",fontSize:20,letterSpacing:-3,fill:"#ffffff",align:"center"}),Q=new Y({fontFamily:"NotoSans Black",fontSize:50,stroke:"#ffffff",strokeThickness:4,dropShadow:!0,dropShadowColor:"#880040",dropShadowAlpha:.5,dropShadowBlur:0,dropShadowAngle:Math.PI/4,dropShadowDistance:6,fill:"#e71477",align:"center"});class se extends m{constructor(){super();n(this,"backgroundImage");n(this,"globe");n(this,"title");n(this,"titleMobile");n(this,"matchText");this.alpha=0,this.backgroundImage=y.from("home/background.jpg"),this.backgroundImage.anchor.set(.5),this.addChild(this.backgroundImage);let t=F.cache.get("home/spine/cst_bg_anim.json");this.globe=new U(t.spineData),this.globe.autoUpdate=!0,this.globe.state.setAnimation(0,"default",!0),this.addChild(this.globe);const e=o.currentState.language===_.Portuguese?o.currentState.language:_.English;t=F.cache.get(`home/spine/cst_logo_${e}_anim.json`),this.title=new U(t.spineData),this.title.autoUpdate=!0,this.addChild(this.title),t=F.cache.get(`home/spine/cst_logo1_${e}_anim.json`),this.titleMobile=new U(t.spineData),this.titleMobile.autoUpdate=!0,this.addChild(this.titleMobile),this.matchText=new w(p().match3,{...xt,fontSize:35}),this.matchText.roundPixels=!0,this.matchText.anchor.set(.5),this.addChild(this.matchText)}resize(t,e){this.backgroundImage.x=t*.5,this.backgroundImage.y=e*.5,A()?(this.titleMobile.x=t*.5,this.titleMobile.y=115,this.titleMobile.visible=!0,this.title.visible=!1,c.currentPopup||(this.titleMobile.state.setAnimation(0,"default",!0),this.title.state.setEmptyAnimations(0)),this.globe.x=t*.5,this.globe.y=e*.5-50,this.matchText.visible=!1):(this.title.x=256,this.title.y=163,this.title.visible=!0,this.titleMobile.visible=!1,c.currentPopup||(this.title.state.setAnimation(0,"default",!0),this.titleMobile.state.setEmptyAnimations(0)),this.globe.x=t*.5-720,this.globe.y=e*.5,this.matchText.x=250,this.matchText.y=320,this.matchText.visible=!0)}async show(){u.killTweensOf(this),await u.to(this,{alpha:1,duration:.6,ease:"linear",delay:1})}pause(){this.title.state.setEmptyAnimations(0),this.titleMobile.state.setEmptyAnimations(0),this.globe.state.setEmptyAnimations(0)}resume(){this.title.state.setAnimation(0,"default",!0),this.titleMobile.state.setAnimation(0,"default",!0),this.globe.state.setAnimation(0,"default",!0)}}function Ct(r){const i=new w(r,{...R,fontSize:25}),t=new S;return t.beginFill(0,.5),t.drawRoundedRect(0,0,i.width+40,i.height+20,(i.height+20)/2),t.moveTo((i.width+40)/2-10,0),t.lineTo((i.width+40)/2,-10),t.lineTo((i.width+40)/2+10,0),t.closePath(),t.endFill(),i.anchor.set(.5),i.x=t.width/2,i.y=t.height/2-5,t.addChild(i),t}class M extends q{constructor(t,e,s,a,l=1){const g=y.from(`button-${t}`),d=y.from(`button-${t}-hover`),h=y.from(`button-${t}-down`),f=y.from(`button-${t}`);l<1&&(g.scale.set(l),d.scale.set(l),h.scale.set(l));super({padding:t==="yellow"?25:18,animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}});n(this,"labelTextStyle");this.defaultView=g,this.hoverView=d,this.pressedView=h,this.disabledView=f,this.anchor.set(.5);const C=t==="yellow"?ht:t==="blue"?ee:ie;this.text=new w(s,{...C,...a}),this.labelTextStyle={...C,...a},this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(e)}changeLabel(t){this.textView=new w(t,this.labelTextStyle)}}class ne extends q{constructor(i){const t=y.from("button-setting"),e=y.from("button-setting");e.tint=16645788;const s=Ct(p().settingsTitle);s.x=-(s.width-e.width)/2,s.y=115,e.addChild(s);const a=y.from("button-setting");a.tint=11184810,super({animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}}),this.defaultView=t,this.hoverView=e,this.pressedView=a,this.anchor.set(.5),this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(i)}}class gt extends q{constructor(t){super({animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}});n(this,"audioOn",!1);n(this,"texture");n(this,"normalSprite");n(this,"disabledSprite");n(this,"buttonType");this.buttonType=t,this.texture=I.from(`button-${t}`),this.normalSprite=new y(this.texture);const e=new y(this.texture);e.tint=16645788;const s=Ct(p()[t]);s.x=-(s.width-e.width)/2,s.y=115,e.addChild(s);const a=new y(this.texture);a.tint=11184810,this.disabledSprite=new y(this.texture),this.disabledSprite.tint=7829367,this.defaultView=this.audioOn?this.normalSprite:this.disabledSprite,this.hoverView=e,this.pressedView=a,this.anchor.set(.5),this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(()=>{this.audioOn=!this.audioOn,this.audioOn?this.defaultView=this.normalSprite:this.defaultView=this.disabledSprite,this.buttonType==="bgm"?(o.currentState.isMuteBGM=!o.currentState.isMuteBGM,o.currentState.isMuteBGM?o.muteBGM():o.unMuteBGM()):(o.currentState.isMuteSFX=!o.currentState.isMuteSFX,o.currentState.isMuteSFX?o.muteSFX():o.unMuteSFX())})}updateState(){this.audioOn=!(this.buttonType==="bgm"?o.currentState.isMuteBGM:o.currentState.isMuteSFX),this.defaultView=this.audioOn?this.normalSprite:this.disabledSprite}}class ft extends q{constructor(i,t=!0){const e=y.from(t?"next":"prev"),s=y.from(t?"next":"prev");s.tint=16645788;const a=y.from(t?"next":"prev");a.tint=11184810;const l=y.from(t?"next":"prev");l.tint=5592405,super({animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}}),this.defaultView=e,this.hoverView=s,this.pressedView=a,this.disabledView=l,this.anchor.set(.5),this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(i)}}class ae extends q{constructor(i){const t=new S().lineStyle(2,15856113,.5).beginFill().drawRoundedRect(0,0,220,70,35).endFill(),e=new S().lineStyle(2,15856113,.5).beginFill().drawRoundedRect(0,0,220,70,35).endFill(),s=new S().lineStyle(2,15856113,.5).beginFill().drawRoundedRect(0,0,220,70,35).endFill();super({animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:50},pressed:{props:{scale:{x:.95,y:.95},y:8},duration:50}}}),this.defaultView=t,this.hoverView=e,this.pressedView=s,this.text=new w(p().settingsDone,{...R,fontSize:30}),this.anchor.set(.5),this.onDown.connect(()=>{x.play("home/sfx-click.mp3")}),this.onPress.connect(i)}}class re extends m{constructor(t){super();n(this,"radioGroup");n(this,"priceTable");const e=new w(p().buyCardsToPlay,{...O,fontSize:45});e.anchor.set(.5),e.y=-320,this.addChild(e),this.priceTable=new m;const s=[];for(let l=0;l<H.length;l++)s.push(new Lt({text:`${H[l]} ${l===0?p().game:p().games}`,style:{unchecked:"radio",checked:"radio_checked",text:{...O,fontSize:35,fill:16776363},textOffset:{x:10}}}));this.radioGroup=new Ft({selectedItem:0,items:s,type:"vertical",elementsMargin:40}),this.radioGroup.onChange.connect((l,g)=>{x.play("home/sfx-click1.ogg"),t({id:l,val:g})}),this.priceTable.addChild(this.radioGroup);const a=new D({elementsMargin:30,vertPadding:10,horPadding:0,type:"vertical"});for(let l=0;l<H.length;l++){const g=new m;let d=0;if(l<H.length-1){const f=new S;f.lineStyle(3,16776363,1),f.moveTo(-270,60),f.lineTo(380,60),g.addChild(f)}const h=new w(E()+" "+z(H[l]*o.currentState.ticketPrice-H[l]*o.currentState.ticketPrice*d/100),{...O,fontSize:30,fill:16776363});h.x=200,g.addChild(h),a.addChild(g)}a.x=250,this.priceTable.addChild(a),this.priceTable.x=-300,this.priceTable.y=-220,this.addChild(this.priceTable)}}class oe extends m{constructor(t){super();n(this,"paytable");n(this,"list");n(this,"button");this.paytable=new m;let e=[[p().tier,p().prizesAvailable,p().award]];for(let a=0;a<o.currentState.prizes.length;a++){const l=o.currentState.prizes[a];e.push([String(a+1),z(l.occurrences,!1),E()+" "+z(Number(l.amount))])}e=[...e,[p().totalTickets+" "+z(o.currentState.ticketPool,!1)],[p().insideTheGame],[p().theoreticalRTP]];const s=[];for(let a=0;a<e.length;a++){const l=new m;if(a<o.currentState.prizes.length+1){for(let d=0;d<3;d++){const h=new w(e[a][d],{...O,fill:16776363});d===1&&(h.x=120),d===2&&(h.x=450),l.addChild(h)}const g=new S;g.lineStyle(2,16776363,1),g.moveTo(0,40),g.lineTo(650,40),l.addChild(g)}else{const g=new w(e[a][0],{...O,fill:16776363,align:"left"});g.y=20,l.addChild(g)}s.push(l)}this.list=new D({children:s,type:"vertical"}),this.paytable.addChild(this.list),this.paytable.x=-320,this.paytable.y=-380,this.button=new M("green",t,p().back,{fontSize:33}),this.button.x=320,this.button.y=730,this.paytable.addChild(this.button),this.addChild(this.paytable)}}class he extends m{constructor(){super();n(this,"spinner");this.spinner=y.from("spinner"),this.spinner.anchor.set(.5),this.addChild(this.spinner)}show(){this.spinner.rotation=0,u.to(this.spinner,{rotation:Math.PI*2,repeat:-1,ease:"linear",duration:2})}hide(){u.killTweensOf(this.spinner)}}class mt extends m{constructor(t,e,s=-.1,a=100){super();n(this,"label");n(this,"slider");const l=320,g=20,d=10,h=4,f=14,C=16769565,v=16775805,P=3845650,N=new S().beginFill(P).drawRoundedRect(0,0,l,g,d).beginFill(3845650).drawRoundedRect(h,h,l-h*2,g-h*2,d).endFill(),lt=new S().beginFill(P).drawRoundedRect(0,0,l,g,d).beginFill(v).drawRoundedRect(h,h,l-h*2,g-h*2,d).endFill(),vt=new S().beginFill(C).drawCircle(0,0,f).endFill();this.slider=new bt({bg:N,fill:lt,slider:vt,min:s,max:a,value:e}),this.addChild(this.slider),this.label=new w(t,{...O,align:"left",fontSize:30}),this.label.anchor.x=0,this.label.x=10,this.label.y=-38,this.addChild(this.label)}connectOnUpdate(t){this.slider.onUpdate.connect(t)}}class le extends bt{constructor(i,t){const f=new S().beginFill(3845650).drawRoundedRect(0,0,800,20,10).endFill(),C=new S().beginFill(16775805).drawRoundedRect(0,0,800,20,10).endFill(),v=new S().beginFill(16769565).drawCircle(0,0,30).endFill();super({bg:f,fill:C,slider:v,min:1,max:i,value:1,valueTextStyle:{fill:0,fontSize:30},showValue:!0}),this.onUpdate.connect(t)}}class ce extends m{constructor(){super();n(this,"title");n(this,"doneButton");n(this,"historyButton");n(this,"layout");n(this,"bgmSlider");n(this,"sfxSlider");this.title=new w(p().settingsTitle,{...O,fontFamily:"NotoSans Black",fontSize:50}),this.title.anchor.set(.5),this.title.y=-250,this.addChild(this.title),this.historyButton=new M("green",()=>{var t,e;(e=(t=c==null?void 0:c.currentPopup)==null?void 0:t.gate)==null||e.call(t,"switchPanel")},p().settingsHistory,{fontSize:25}),this.historyButton.y=110,this.addChild(this.historyButton),this.doneButton=new M("green",()=>{c.dismissPopup()},p().settingsDone,{fontSize:35}),this.doneButton.y=220,this.addChild(this.doneButton),this.layout=new D({type:"vertical",elementsMargin:25}),this.layout.x=-160,this.layout.y=-160,this.addChild(this.layout),this.bgmSlider=new mt(p().settingsBgm,o.getBgmVolume()*100),this.bgmSlider.connectOnUpdate(t=>{var e,s;o.setBgmVolume(t/100),(s=(e=c==null?void 0:c.currentScreen)==null?void 0:e.gate)==null||s.call(e,"updateBGMButton")}),this.layout.addChild(this.bgmSlider),this.sfxSlider=new mt(p().settingsSfx,o.getSfxVolume()*100),this.sfxSlider.connectOnUpdate(t=>{var e,s;o.setSfxVolume(t/100),(s=(e=c==null?void 0:c.currentScreen)==null?void 0:e.gate)==null||s.call(e,"updateSFXButton")}),this.layout.addChild(this.sfxSlider)}}class tt extends m{constructor(t){super();n(this,"cardBackground");n(this,"renderTexture");n(this,"renderTextureSprite");n(this,"cardCover");n(this,"dragging",!1);n(this,"brush");n(this,"cards");n(this,"cardRevealed",[]);n(this,"symbolSprites",[]);n(this,"sameCards",{});n(this,"cardBackHighlightTexture",I.from("card_back_highlight"));n(this,"scratchSoundIndex",0);n(this,"isScratched",!1);const e=[-275,0,275],s=[-275,0,275];this.cards=t,this.brush=y.from("brush"),this.brush.anchor.set(.5),this.cardCover=new m;const a=I.from("card_cover");this.cardBackground=new m;const l=I.from("card_back"),g={};o.currentState.prizes.map(h=>{g[h.symbols[0]]=h.amount});for(let h=0;h<t.length;h++){let f=new y(a);f.anchor.set(.5),f.x=e[h%3],f.y=s[Math.floor(h/3)],this.cardCover.addChild(f),this.symbolSprites[h]=new y(l),this.symbolSprites[h].anchor.set(.5),this.symbolSprites[h].x=e[h%3],this.symbolSprites[h].y=s[Math.floor(h/3)];const C=F.cache.get(`home/spine/cst_element${t[h]}_anim.json`),v=new U(C.spineData);v.autoUpdate=!1,v.state.setAnimation(0,"default",!1),v.state.tracks[0].trackTime=0,v.update(0),this.symbolSprites[h].addChild(v);let P="";t[h]===0?P=p().freeplayCapital:P=E()+" "+String(g[t[h]]);const T=new rt(P,{fontName:"impact_night",fontSize:40,letterSpacing:-10,align:"center"});if(T.anchor.set(.5),T.width>270){const N=T.width/T.height;T.width=250,T.height=250/N}T.y=95,T.x=5,this.symbolSprites[h].addChild(T),this.cardBackground.addChild(this.symbolSprites[h])}const d=new S;d.beginFill(16181525),d.drawRect(-(B/2),-(B/2),B,B),d.endFill(),this.addChild(d),this.renderTexture=At.create({width:B,height:B}),this.renderTextureSprite=new y(this.renderTexture),this.renderTextureSprite.anchor.set(.5),this.cardBackground.mask=this.renderTextureSprite,this.addChild(this.cardCover,this.cardBackground,this.renderTextureSprite),this.eventMode="static",this.hitArea=new Mt(-(B/2),-(B/2),B,B),this.on("pointermove",this.pointerMove).on("pointerdown",this.pointerDown).on("pointerup",this.pointerUp).on("pointerupoutside",this.pointerUp)}pointerMove(t){if(!this.dragging)return;const{x:e,y:s}=t.data.getLocalPosition(this),a=e+B/2,l=s+B/2;this.brush.position.set(a,l),k.renderer.render(this.brush,{renderTexture:this.renderTexture,clear:!1,skipUpdateTransform:!1}),x.play(`home/sfx-scratch${this.scratchSoundIndex}.ogg`),this.scratchSoundIndex++,this.scratchSoundIndex>10&&(this.scratchSoundIndex=0),St("isScratching",200,()=>{if(this.getPaintedPercentage())this.reveal();else{this.sameCards={},this.cardRevealed.map((g,d)=>{g&&(this.sameCards[this.cards[d]]?this.sameCards[this.cards[d]].push(d):this.sameCards[this.cards[d]]=[d])});for(const g in this.sameCards)if(this.sameCards[g].length>1)for(let d=0;d<this.sameCards[g].length;d++){const h=this.symbolSprites[this.sameCards[g][d]].getChildAt(0);u.isTweening(h)||(u.to(h,{alpha:.3,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}),x.play("home/sfx-hint.ogg"));const f=this.symbolSprites[this.sameCards[g][d]].getChildAt(1);u.isTweening(f)||u.to(f,{alpha:.3,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"})}}})}pointerDown(t){this.dragging=!0,this.pointerMove(t)}pointerUp(){this.dragging=!1}getPaintedPercentage(){const t=k.renderer.extract.pixels(this.renderTexture),e=t.length/Z,s=e/9,a=Math.sqrt(e),l=a/3,g=new Array(9).fill(0);for(let h=0;h<t.length;h+=Z){const f=Math.floor(Math.floor(h/Z)%a/l),v=3*Math.floor(Math.floor(h/Z)/a/l)+f;t[h+3]===255&&g[v]++}let d=!0;for(let h=0;h<9;h++){const f=g[h];this.cardRevealed[h]=f*100/s>Vt,d=d&&this.cardRevealed[h]}return this.isScratched=d,d}showResult(){var t=new S;t.beginFill(16777215),t.drawRect(0,0,B,B),t.endFill(),this.eventMode="none",k.renderer.render(t,{renderTexture:this.renderTexture,clear:!1,skipUpdateTransform:!1}),this.sameCards={};for(let e=0;e<9;e++)this.sameCards[this.cards[e]]?this.sameCards[this.cards[e]].push(e):this.sameCards[this.cards[e]]=[e];for(const e in this.sameCards)if(this.sameCards[e].length>2)for(let s=0;s<this.sameCards[e].length;s++)this.symbolSprites[this.sameCards[e][s]].texture=this.cardBackHighlightTexture}reveal(){this.dragging=!1;let t=0;const e=()=>{var a,l;var s=new S;if(s.beginFill(16777215),s.drawRect(0,0,B,t),s.endFill(),k.renderer.render(s,{renderTexture:this.renderTexture,clear:!1,skipUpdateTransform:!1}),t+=40,t>840){k.ticker.remove(e);const g=[];this.eventMode="none",this.isScratched=!0,this.sameCards={};for(let d=0;d<9;d++)this.sameCards[this.cards[d]]?this.sameCards[this.cards[d]].push(d):this.sameCards[this.cards[d]]=[d];for(const d in this.sameCards)if(this.sameCards[d].length>=3&&g.push(Number(d)),this.sameCards[d].length>1)for(let h=0;h<this.sameCards[d].length;h++){const f=this.symbolSprites[this.sameCards[d][h]].getChildAt(0),C=this.symbolSprites[this.sameCards[d][h]].getChildAt(1);u.killTweensOf(f),u.killTweensOf(C),C.alpha=1,f.alpha=1,this.sameCards[d].length>=3&&(this.symbolSprites[this.sameCards[d][h]].texture=this.cardBackHighlightTexture,f.autoUpdate=!0,f.state.setAnimation(0,"default",!0),Number(d)>0&&u.to(C.scale,{x:1.2,y:1.2,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}))}(l=(a=c==null?void 0:c.currentScreen)==null?void 0:a.gate)==null||l.call(a,"finishRound",g)}};k.ticker.add(e)}pause(){if(this.isScratched)for(let t=0;t<9;t++){const e=this.symbolSprites[t].getChildAt(0);if(e.autoUpdate=!1,e.state.setAnimation(0,"default",!1),e.state.tracks[0].trackTime=0,e.update(0),this.cards[t]>0){const s=this.symbolSprites[t].getChildAt(1);u.killTweensOf(s.scale),s.scale.set(1)}}else for(let t=0;t<this.cardRevealed.length;t++)if(this.cardRevealed[t]){const e=this.symbolSprites[t].getChildAt(0);u.isTweening(e)&&(u.killTweensOf(e),e.alpha=1);const s=this.symbolSprites[t].getChildAt(1);u.isTweening(s)&&(u.killTweensOf(s),s.alpha=1)}}resume(){for(const t in this.sameCards)if(this.sameCards[t].length>(this.isScratched?2:1))for(let e=0;e<this.sameCards[t].length;e++){const s=this.symbolSprites[this.sameCards[t][e]].getChildAt(0),a=this.symbolSprites[this.sameCards[t][e]].getChildAt(1);this.isScratched?(s.autoUpdate=!0,s.state.setAnimation(0,"default",!0),Number(t)>0&&u.to(a.scale,{x:1.2,y:1.2,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"})):(u.to(s,{alpha:.3,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}),u.to(a,{alpha:.3,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}))}}}class st extends m{constructor(t){super();n(this,"messageBox",new S);n(this,"okButton");n(this,"headerText");n(this,"messageText");this.addChild(this.messageBox),this.headerText=new w(p().message,{...R,fontSize:30,letterSpacing:0}),this.headerText.anchor.set(.5),this.messageBox.addChild(this.headerText),this.okButton=new ae(()=>{c.dismissPopup()}),this.messageBox.addChild(this.okButton),this.messageText=new w(t,{...R,fontSize:30,wordWrap:!0,letterSpacing:0}),this.messageText.anchor.set(.5),this.messageBox.addChild(this.messageText)}resize(t,e){const s=t>800?800:t-50,a=e>600?600:e-50;this.headerText.x=s/2,this.headerText.y=50,this.messageBox.clear(),this.messageBox.beginFill(655397,.9),this.messageBox.drawRoundedRect(0,0,s,a,30),this.messageBox.endFill(),this.messageBox.x=t/2-s/2,this.messageBox.y=e/2-a/2,this.okButton.x=s/2,this.okButton.y=a-70,this.messageText.style.wordWrapWidth=s-100,this.messageText.x=s/2,this.messageText.y=a/2}async show(){c.currentScreen&&(c.currentScreen.filters=[new $(5)]),c.background&&(c.background.filters=[new $(5)]),u.killTweensOf(this.messageBox.pivot),this.messageBox.pivot.y=-400,u.to(this.messageBox.pivot,{y:0,duration:.3,ease:"back.out"})}async hide(){c.currentScreen&&(c.currentScreen.filters=null),c.background&&(c.background.filters=null),u.killTweensOf(this.messageBox.pivot),await u.to(this.messageBox.pivot,{y:-500,duration:.3,ease:"back.in"})}}class de extends m{constructor(){super();n(this,"title");n(this,"doneButton");n(this,"settingsButton");n(this,"historyData",[]);n(this,"spinner");n(this,"cardFrame");n(this,"cardLayer");n(this,"scratchPan");n(this,"buttonList");n(this,"pageIndex",0);n(this,"prevButton");n(this,"nextButton");n(this,"paginationSlider");n(this,"winAmountText");n(this,"dateText");n(this,"currency","");n(this,"totalPage",0);this.title=new w(p().settingsHistory.replace(/\n/g," "),{...O,fontSize:40}),this.title.anchor.set(.5),this.title.y=-420,this.addChild(this.title),this.cardFrame=new wt,this.cardFrame.visible=!1,this.cardFrame.scale.set(.6),this.cardFrame.y=-120,this.addChild(this.cardFrame),this.cardLayer=new m,this.cardFrame.addChild(this.cardLayer),this.prevButton=new ft(()=>this.onClickPrev(),!1),this.prevButton.x=-435,this.nextButton=new ft(()=>this.onClickNext()),this.nextButton.x=435,this.cardFrame.addChild(this.prevButton),this.cardFrame.addChild(this.nextButton);const t=new D({type:"vertical",elementsMargin:15});t.x=-400,t.y=555,this.cardFrame.addChild(t),this.winAmountText=new w(`${p().winAmount}:`,{...R,fontSize:40}),t.addChild(this.winAmountText),this.dateText=new w(`${p().date}:`,{...R,fontSize:40}),t.addChild(this.dateText),this.buttonList=new D({type:"horizontal",elementsMargin:25}),this.buttonList.y=420,this.buttonList.x=-140,this.addChild(this.buttonList),this.settingsButton=new M("green",()=>{var e,s;(s=(e=c==null?void 0:c.currentPopup)==null?void 0:e.gate)==null||s.call(e,"switchPanel")},p().settingsTitle,{fontSize:25}),this.settingsButton.y=120,this.buttonList.addChild(this.settingsButton),this.doneButton=new M("green",()=>{c.dismissPopup()},p().settingsDone,{fontSize:35}),this.doneButton.y=220,this.buttonList.addChild(this.doneButton),this.spinner=y.from("spinner"),this.spinner.anchor.set(.5),this.spinner.y=-110,this.addChild(this.spinner)}async getHistoryFromServer(){if(this.historyData.length>0)this.spinner.visible=!1,u.killTweensOf(this.spinner),this.showHistory();else{this.showLoadingSpinner();try{const t=await G.get(`${j}/${X}/history?page=${this.pageIndex+1}&per_page=1`);this.historyData=t.data.data.history,this.currency=t.data.data.currency,this.totalPage=t.data.meta.total,this.spinner.visible=!1,this.cardFrame.visible=!0,u.killTweensOf(this.spinner),this.paginationSlider=new le(this.totalPage,e=>{St("pageUpdate",500,()=>{this.onPageSliderChange(e)})}),this.paginationSlider.y=485,this.paginationSlider.x=-400,this.cardFrame.addChild(this.paginationSlider),this.showHistory()}catch{this.hideLoadingSpinner(),c.presentPopup(st,p().wrong)}}}async showHistory(){var e;const t=this.historyData[0];(e=this.scratchPan)==null||e.removeFromParent(),this.scratchPan=new tt(t.cards),this.scratchPan.showResult(),this.updateText(),this.updatePrevNextButtonState(),this.cardLayer.addChild(this.scratchPan)}showLoadingSpinner(){this.spinner.visible=!0,u.killTweensOf(this.spinner),this.spinner.rotation=0,u.to(this.spinner,{rotation:Math.PI*2,repeat:-1,ease:"linear",duration:2})}hideLoadingSpinner(){this.spinner.visible=!1,u.killTweensOf(this.spinner)}async updateHistoryFromServer(){this.showLoadingSpinner();try{const t=await G.get(`${j}/${X}/history?page=${this.pageIndex+1}&per_page=1`);this.historyData=t.data.data.history,this.currency=t.data.data.currency,this.hideLoadingSpinner(),this.showHistory()}catch{this.hideLoadingSpinner(),c.presentPopup(st,p().wrong)}}async onClickNext(){this.pageIndex++,await this.updateHistoryFromServer(),this.paginationSlider.value=this.pageIndex+1}async onClickPrev(){this.pageIndex--,await this.updateHistoryFromServer(),this.paginationSlider.value=this.pageIndex+1}updateText(){const t=this.historyData[0];this.winAmountText.text=`${p().winAmount}: ${this.currency} ${Number(t.prize)}`,this.dateText.text=`${p().date}: ${new Date(t.timestamp).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})}`}updatePrevNextButtonState(){this.prevButton.enabled=this.pageIndex>0,this.nextButton.enabled=this.pageIndex<this.totalPage-1}onPageSliderChange(t){Math.round(t)-1!==this.pageIndex&&(this.pageIndex=Math.round(t)-1,this.updateHistoryFromServer())}}class ue extends m{constructor(){super();n(this,"bg");n(this,"settingPanel");n(this,"historyPanel");this.bg=y.from(I.WHITE),this.bg.tint=655397,this.bg.eventMode="static",this.addChild(this.bg),this.settingPanel=new ce,this.addChild(this.settingPanel),this.historyPanel=new de,this.historyPanel.visible=!1,this.addChild(this.historyPanel)}resize(t,e){if(this.bg.width=t,this.bg.height=e,this.settingPanel.x=t*.5,this.settingPanel.y=e*.5,this.historyPanel.x=t*.5,this.historyPanel.y=e*.5,A()){const s=Nt,a=Gt,l=window.innerWidth<s?s/window.innerWidth:1,g=window.innerHeight<a?a/window.innerHeight:1,d=l>g?l:g;this.settingPanel.scale.set(d)}}async show(){c.currentScreen&&(c.currentScreen.filters=[new $(5)]),c.background&&(c.background.filters=[new $(5)]),u.killTweensOf(this.bg),u.killTweensOf(this.settingPanel.pivot),this.bg.alpha=0,this.settingPanel.pivot.y=-400,u.to(this.bg,{alpha:.8,duration:.2,ease:"linear"}),await u.to(this.settingPanel.pivot,{y:0,duration:.3,ease:"back.out"})}async hide(){c.currentScreen&&(c.currentScreen.filters=null),c.background&&(c.background.filters=null),u.killTweensOf(this.bg),u.killTweensOf(this.settingPanel.pivot),u.to(this.bg,{alpha:0,duration:.2,ease:"linear",delay:.3}),await u.to(this.settingPanel.pivot,{y:-500,duration:.3,ease:"back.in"})}gate(t){switch(t){case"switchPanel":this.settingPanel.visible=!this.settingPanel.visible,this.historyPanel.visible=!this.settingPanel.visible,this.historyPanel.visible&&this.historyPanel.getHistoryFromServer();break}}}class pe extends m{constructor(){super();n(this,"settingButton");n(this,"sfxButton");n(this,"bgmButton");this.settingButton=new ne(()=>{c.presentPopup(ue)}),this.sfxButton=new gt("sfx"),this.bgmButton=new gt("bgm"),this.addChild(this.settingButton),this.sfxButton.x=120,this.addChild(this.sfxButton),this.bgmButton.x=240,this.addChild(this.bgmButton)}updateAudioBtn(t){t==="sfx"?this.sfxButton.updateState():this.bgmButton.updateState()}}class ge extends m{constructor(t){super();n(this,"graphics",new S);n(this,"credit");n(this,"totalWin");n(this,"win");this.graphics.lineStyle(4,14803425,1),this.graphics.beginFill(1261982,.75),this.graphics.drawRect(0,0,1928,119),this.graphics.endFill(),this.addChild(this.graphics),this.credit=new w(p().credit+`
`+E()+" "+z(t),R),this.credit.anchor.set(0),this.addChild(this.credit),this.totalWin=new w(p().totalWin,R),this.totalWin.anchor.set(.5,0),this.totalWin.visible=!1,this.addChild(this.totalWin),this.win=new w(p().win,R),this.win.anchor.set(1,0),this.win.visible=!1,this.addChild(this.win)}resize(t,e){this.x=-4,A()?(this.y=e-90,this.totalWin.x=t*.5,this.totalWin.y=25,this.credit.x=t*.5-290,this.credit.y=10,this.win.x=t*.5+295,this.win.y=10,this.totalWin.y=10,this.credit.style.fontSize=28):(this.y=e-115,this.credit.x=250,this.credit.y=6,this.win.x=t-250,this.win.y=6,this.totalWin.y=6,this.credit.style.fontSize=45),this.totalWin.x=t*.5}setValue(t,e,s){this.credit.text=p().credit+`
`+E()+" "+z(t),e===0?this.win.visible=!1:(this.win.visible=!0,this.win.text=p().win+`
`+E()+" "+z(e)),s===0?this.totalWin.visible=!1:(this.totalWin.visible=!0,this.totalWin.text=p().totalWin+`
`+E()+" "+z(s))}}class fe extends m{constructor(){super();n(this,"tickets");n(this,"darkBackground");n(this,"backgroundSprite");n(this,"cardLeftText");n(this,"textGroup");this.darkBackground=new S,this.darkBackground.beginFill(0,.5),this.darkBackground.drawRect(-540,-25,1080,50),this.darkBackground.endFill(),this.addChild(this.darkBackground),this.backgroundSprite=y.from("cards_left"),this.backgroundSprite.anchor.set(.5),this.addChild(this.backgroundSprite),this.textGroup=new D({type:"vertical",elementsMargin:30}),this.addChild(this.textGroup),this.tickets=new rt(String(o.currentState.ticketsLeft),{fontName:"golden_number",letterSpacing:0,align:"center"}),this.tickets.anchor.set(.5),this.textGroup.addChild(this.tickets),this.cardLeftText=new w(p().ticketsLeftMobile,{...Q,fontSize:33,strokeThickness:3}),this.cardLeftText.anchor.set(.5),this.textGroup.addChild(this.cardLeftText)}resize(t,e){t<e?(this.backgroundSprite.visible=!1,this.darkBackground.visible=!0,this.cardLeftText.text=p().ticketsLeftMobile,this.cardLeftText.style={...Q,fontSize:33,strokeThickness:3},this.cardLeftText.anchor.set(0,.5),this.tickets.fontSize=30,this.tickets.anchor.set(.5),this.textGroup.type="horizontal",this.textGroup.elementsMargin=15,this.textGroup.x=-(this.textGroup.width/2)+15,this.textGroup.y=0):(this.backgroundSprite.visible=!0,this.darkBackground.visible=!1,this.cardLeftText.text=p().ticketsLeft,this.cardLeftText.style=Q,this.cardLeftText.anchor.set(.5),this.tickets.fontSize=80,this.tickets.anchor.set(.5),this.textGroup.type="vertical",this.textGroup.elementsMargin=30,this.textGroup.x=0,this.textGroup.y=-50)}setNumber(t,e=!1){t<0||(this.tickets.text=String(t),e&&(u.killTweensOf(this.tickets.scale),u.to(this.tickets.scale,{x:1.3,y:1.3,repeat:1,duration:.2,yoyo:!0,ease:"sine.inOut"})))}}class me extends m{constructor(){super();const i=y.from("freeplay");i.anchor.set(.5),this.addChild(i);const t=new w(p().freeplayCapital,{...Q,fontSize:40});if(t.anchor.set(.5),t.width>270){const e=t.width/t.height;t.width=250,t.height=250/e}this.addChild(t)}}class ye extends m{constructor(){super();n(this,"bg");n(this,"coinContainer",new m);n(this,"coinTextures",[]);n(this,"timer",0);n(this,"coinCount",0);n(this,"fallingSpeed",20);n(this,"screenWidth",0);n(this,"youWonSpine");n(this,"moneyString");n(this,"clickToContinue");this.bg=y.from(I.WHITE),this.bg.tint=655397,this.addChild(this.bg),this.addChild(this.coinContainer);let t;for(t=0;t<10;t++){const a=I.from(`coin${t}`);this.coinTextures.push(a)}const e=o.currentState.language===_.Portuguese?o.currentState.language:_.English,s=F.cache.get(`home/spine/cst_won_${e}_anim.json`);this.youWonSpine=new U(s.spineData),this.youWonSpine.autoUpdate=!0,this.youWonSpine.state.setAnimation(0,"default",!0),this.addChild(this.youWonSpine),this.moneyString=new rt(E()+o.currentState.totalWin,{fontName:"impact_night",fontSize:50,align:"center"}),this.moneyString.anchor.set(.5),this.addChild(this.moneyString),u.killTweensOf(this.moneyString.scale),u.to(this.moneyString.scale,{x:1.3,y:1.3,yoyo:!0,repeat:-1,ease:"sine.inOut",duration:.5}),this.clickToContinue=new w(p().clickToContinue,xt),this.clickToContinue.anchor.set(.5),this.addChild(this.clickToContinue),this.eventMode="static",this.on("pointerdown",()=>{c.dismissPopup()})}resize(t,e){this.bg.width=t,this.bg.height=e,this.youWonSpine.x=t*.5,this.youWonSpine.y=e*.5-250,this.moneyString.x=t*.5,this.moneyString.y=e*.5,this.clickToContinue.x=t*.5,this.clickToContinue.y=e*.5+200,this.screenWidth=t,t<e?(this.coinCount=5,this.youWonSpine.scale.set(.8),this.moneyString.fontSize=60,this.fallingSpeed=20,this.clickToContinue.style.fontSize=25):(this.coinCount=8,this.youWonSpine.scale.set(1),this.moneyString.fontSize=80,this.fallingSpeed=30,this.clickToContinue.style.fontSize=30),this.coinContainer.removeChildren(),this.timer=0,this.generateCoins(t,!1),this.generateCoins(t)}update(t){let e;if(this.timer>60)for(this.timer=0,this.generateCoins(this.screenWidth),e=0;e<this.coinContainer.children.length;e++)this.coinContainer.children[e].y>b&&this.coinContainer.children[e].removeFromParent();for(e=0;e<this.coinContainer.children.length;e++)this.coinContainer.children[e].y+=Math.floor(Math.random()*this.fallingSpeed)+1;this.timer+=t}generateCoins(t,e=!0){let s;for(s=0;s<this.coinCount;s++){const a=new Rt(this.coinTextures);a.x=Math.random()*t,a.y=e?Math.random()*b-b:Math.random()*b,a.anchor.set(.5),a.rotation=Math.random()*Math.PI,a.scale.set(.5+Math.random()*.5),a.animationSpeed=.2,a.gotoAndPlay(Math.random()*10|0),this.coinContainer.addChild(a)}}async show(){c.currentScreen&&(c.currentScreen.filters=[new $(5)]),c.background&&(c.background.filters=[new $(5)]),V.play("home/sfx-celebration.ogg"),u.killTweensOf(this.bg),this.bg.alpha=0,u.to(this.bg,{alpha:.8,duration:.3,ease:"linear"})}async hide(){c.currentScreen&&(c.currentScreen.filters=null),c.background&&(c.background.filters=null),V.play("home/bgm.mp3"),this.coinContainer.removeChildren(),u.killTweensOf(this.bg),u.to(this.bg,{alpha:0,duration:.2,ease:"linear",delay:.3})}}class Bt extends m{constructor(){super();n(this,"bottomContainer");n(this,"cardFrame");n(this,"paytableButton");n(this,"buyNowButton");n(this,"scratchButton");n(this,"autoplayButton");n(this,"buyTicketContainer");n(this,"paytableContainer");n(this,"loadingContainer");n(this,"settingAudioContainer");n(this,"cardsLeftContainer");n(this,"scratchPan");n(this,"prevFrameContent","buyNow");n(this,"timeout");this.paytableButton=new M("blue",()=>{this.showPaytable(!0)},p().paytable,{fontSize:33}),this.addChild(this.paytableButton),this.scratchButton=new M("yellow",()=>{this.scratch()},p().scratch,{fontSize:40}),this.scratchButton.enabled=!1,this.scratchButton.alpha=.6,this.addChild(this.scratchButton),this.autoplayButton=new M("green",()=>{this.autoPlay()},p().autoplay,{fontSize:33}),this.autoplayButton.enabled=!1,this.autoplayButton.alpha=.6,this.addChild(this.autoplayButton),this.cardFrame=new wt,this.addChild(this.cardFrame),this.buyTicketContainer=new re(t=>{o.setGameState({buyTickets:Number(t.val.split(" ")[0])})}),this.buyNowButton=new M("green",()=>{this.startGame()},p().buyNow,{fontSize:33}),this.buyNowButton.y=300,this.buyTicketContainer.addChild(this.buyNowButton),this.cardFrame.addChild(this.buyTicketContainer),this.paytableContainer=new oe(()=>{this.showPaytable(!1)}),this.paytableContainer.visible=!1,this.cardFrame.addChild(this.paytableContainer),this.loadingContainer=new he,this.loadingContainer.visible=!1,this.cardFrame.addChild(this.loadingContainer),this.cardsLeftContainer=new fe,this.cardsLeftContainer.visible=!1,this.addChild(this.cardsLeftContainer),this.settingAudioContainer=new pe,this.addChild(this.settingAudioContainer),this.bottomContainer=new ge(o.currentState.credit),this.addChild(this.bottomContainer),this.alpha=0}resize(t,e){A()?(this.cardFrame.x=t*.5,this.cardFrame.y=e*.5-90,this.cardFrame.scale.set(.67),this.settingAudioContainer.x=t*.5-250,this.settingAudioContainer.y=40,this.settingAudioContainer.scale.set(.6),this.cardsLeftContainer.x=t*.5,this.cardsLeftContainer.y=e*.5+239,this.paytableButton.x=t*.5+200,this.paytableButton.scale.set(.8),o.currentState.isGameStarted?(this.scratchButton.y=860,this.autoplayButton.y=945,this.paytableButton.y=945):(this.scratchButton.y=830,this.autoplayButton.y=925,this.paytableButton.y=925),this.autoplayButton.x=t*.5-200,this.autoplayButton.scale.set(.8),this.scratchButton.x=t*.5,this.scratchButton.scale.set(.8),this.buyNowButton.scale.set(1.3)):(this.cardFrame.x=t*.5,this.cardFrame.y=e*.5-60,this.cardFrame.scale.set(1),this.settingAudioContainer.scale.set(1),this.settingAudioContainer.x=t-330,this.settingAudioContainer.y=100,this.paytableButton.x=250,this.paytableButton.y=860,this.paytableButton.scale.set(1.2),this.autoplayButton.x=t-250,this.autoplayButton.y=860,this.autoplayButton.scale.set(1.2),this.scratchButton.x=t-250,this.scratchButton.y=700,this.scratchButton.scale.set(1.2),this.cardsLeftContainer.x=1670,this.cardsLeftContainer.y=400,this.buyNowButton.scale.set(1)),this.bottomContainer.resize(t,e),this.cardsLeftContainer.resize(t,e)}async show(){V.play("home/bgm.mp3"),u.killTweensOf(this),await u.to(this,{alpha:1,duration:.6,ease:"linear"}),o.currentState.ticketsLeft>0&&o.currentState.nextCards.length>0&&this.resumeGame()}async prepare(){u.killTweensOf(this.buyNowButton.scale),u.to(this.buyNowButton.scale,{x:1.2,y:1.2,duration:.5,repeat:-1,yoyo:!0,ease:"sine.inOut"})}async hide(){u.killTweensOf(this),await u.to(this,{alpha:0,duration:.6,ease:"linear"})}pause(){var t,e,s,a;(e=(t=c==null?void 0:c.background)==null?void 0:t.pause)==null||e.call(t),(s=this.scratchPan)!=null&&s.visible&&((a=this.scratchPan)==null||a.pause()),u.killTweensOf(this.buyNowButton.scale),this.buyNowButton.scale.set(1)}resume(){var t,e,s,a;(e=(t=c==null?void 0:c.background)==null?void 0:t.resume)==null||e.call(t),(s=this.scratchPan)!=null&&s.visible&&((a=this.scratchPan)==null||a.resume()),this.prepare()}showPaytable(t){t?(this.buyTicketContainer.visible=!1,this.scratchPan&&(this.scratchPan.visible=!1)):this.prevFrameContent==="buyNow"?this.buyTicketContainer.visible=!0:this.prevFrameContent==="scratchPan"&&(this.scratchPan.visible=!0),this.paytableContainer.visible=t}async startGame(){var s;const e=o.currentState.buyTickets*o.currentState.ticketPrice-o.currentState.buyTickets*o.currentState.ticketPrice*0/100;if(o.currentState.credit>=e){this.eventMode="none",this.showLoading(!0);try{const a=await G.post(`${j}/${X}/tickets`,{tickets:o.currentState.buyTickets}),{balance:l,ticketsLeft:g,nextCards:d}=a.data;if(o.setGameState({isGameStarted:!0,credit:l,ticketsLeft:g,nextCards:d}),this.prevFrameContent="scratchPan",this.setButtonEnabled(this.scratchButton,!0),this.setButtonEnabled(this.autoplayButton,!0),this.scratchPan=new tt(o.currentState.nextCards),this.cardFrame.addChild(this.scratchPan),this.cardsLeftContainer.setNumber(g),this.bottomContainer.setValue(l,0,0),this.scratchButton.changeLabel(p().scratch),A()){const h=window.innerHeight/window.innerWidth,f=W/b;h>f?this.paytableButton.x=b/f/2+200:this.paytableButton.x=b/h/2+200,this.scratchButton.y=860,this.autoplayButton.y=945,this.paytableButton.y=945}this.cardsLeftContainer.visible=!0,this.showLoading(!1),this.eventMode="static"}catch(a){G.isAxiosError(a)?this.onRequestErrorHandler((s=a.response)==null?void 0:s.data.message):this.onRequestErrorHandler(p().wrong)}}else c.presentPopup(st,p().insufficientBalance)}async resumeGame(){if(this.eventMode="none",this.showLoading(!0),o.currentState.isGameStarted=!0,this.prevFrameContent="scratchPan",this.setButtonEnabled(this.scratchButton,!0),this.setButtonEnabled(this.autoplayButton,!0),this.scratchPan=new tt(o.currentState.nextCards),this.cardFrame.addChild(this.scratchPan),this.cardsLeftContainer.setNumber(o.currentState.ticketsLeft),this.scratchButton.changeLabel(p().scratch),A()){const t=window.innerHeight/window.innerWidth,e=W/b;t>e?this.paytableButton.x=b/e/2+200:this.paytableButton.x=b/t/2+200,this.scratchButton.y=860,this.autoplayButton.y=945,this.paytableButton.y=945}this.cardsLeftContainer.visible=!0,this.showLoading(!1),this.eventMode="static"}scratch(){var t;o.currentState.ticketsLeft>0?o.currentState.isScratched?this.nextRound():(this.paytableButton.visible&&this.showPaytable(!1),o.currentState.isScratched||(t=this.scratchPan)==null||t.reveal()):this.finishGame()}gate(t,e){switch(t){case"updateSFXButton":this.settingAudioContainer.updateAudioBtn("sfx");break;case"updateBGMButton":this.settingAudioContainer.updateAudioBtn("bgm");break;case"finishRound":this.finishRound(e);break}}async finishRound(t){var e;this.setAllButtonState(!1);try{const s=await G.post(`${j}/${X}/play`),{prize:a,cards:l,balance:g,currency:d,ticketsLeft:h,nextCards:f}=s.data;o.setGameState({roundResult:{prize:a,cards:l,balance:g,currency:d,ticketsLeft:h},nextCards:f}),o.currentState.ticketsLeft=h,this.cardsLeftContainer.setNumber(h),o.currentState.isScratched=!0;let C=1e3;if(t.length>0){C=3e3;let v=o.currentState.totalWin+a,P=Number(a),T=g;for(let N=0;N<t.length;N++)t[N]===0&&(o.currentState.ticketsLeft=o.currentState.ticketsLeft+1,this.freeplayAnimation());o.setGameState({win:P,totalWin:v,credit:T}),P>=100?x.play("home/sfx-bigwin.ogg"):P>=10?x.play("home/sfx-mediumwin.ogg"):P>0?x.play("home/sfx-smallwin.ogg"):x.play("home/sfx-freeplay.ogg"),this.bottomContainer.setValue(T,P,v)}o.currentState.ticketsLeft>0?(this.scratchButton.changeLabel(p().playNext),o.currentState.isAutoPlay&&(this.timeout=setTimeout(()=>this.nextRound(),C))):(this.scratchButton.changeLabel(p().buyMoreTickets),o.currentState.isAutoPlay&&this.autoPlay(),this.setButtonEnabled(this.autoplayButton,!1),o.currentState.totalWin>0?c.presentPopup(ye):x.play("home/sfx-fail.ogg")),this.setAllButtonState(!0)}catch(s){G.isAxiosError(s)?this.onRequestErrorHandler((e=s.response)==null?void 0:e.data.message):this.onRequestErrorHandler(p().wrong)}}async nextRound(){var t;o.currentState.isAutoPlay||clearTimeout(this.timeout),this.setAllButtonState(!1),(t=this.scratchPan)==null||t.removeFromParent(),this.scratchPan=new tt(o.currentState.nextCards),o.currentState.isAutoPlay&&(this.scratchPan.eventMode="none"),this.cardFrame.addChild(this.scratchPan),this.scratchButton.changeLabel(p().scratch),o.currentState.isScratched=!1,this.bottomContainer.setValue(o.currentState.credit,0,o.currentState.totalWin),o.currentState.isAutoPlay&&(o.currentState.ticketsLeft>0?setTimeout(()=>this.scratch(),500):o.currentState.isAutoPlay=!1),this.setAllButtonState(!0)}autoPlay(){if(o.currentState.isAutoPlay=!o.currentState.isAutoPlay,o.currentState.isAutoPlay){if(o.currentState.ticketsLeft===0)return;this.scratchButton.visible=!1,this.setButtonEnabled(this.paytableButton,!1),this.autoplayButton.changeLabel(p().stop),this.scratch()}else this.scratchButton.visible=!0,this.setButtonEnabled(this.paytableButton,!0),clearTimeout(this.timeout),this.autoplayButton.changeLabel(p().autoplay)}finishGame(){var t;o.setGameState({isGameStarted:!1,totalWin:0,win:0,isScratched:!1,isAutoPlay:!1}),this.prevFrameContent="buyNow",this.buyTicketContainer.visible=!0,this.paytableContainer.visible=!1,this.scratchButton.enabled=!1,this.scratchButton.alpha=.6,this.scratchButton.changeLabel(p().scratch),(t=this.scratchPan)==null||t.removeFromParent(),this.cardsLeftContainer.visible=!1,this.bottomContainer.setValue(o.currentState.credit,0,0),A()&&(this.scratchButton.y=830,this.autoplayButton.y=925,this.paytableButton.y=925)}async freeplayAnimation(){this.setButtonEnabled(this.scratchButton,!1),this.setButtonEnabled(this.autoplayButton,!1);const t=new me;if(t.alpha=0,t.scale.set(.2),A()){const e=window.innerHeight/window.innerWidth,s=W/b;e>s?t.x=b/s/2:t.x=b/e/2}else t.x=960;t.y=540,this.addChild(t),u.killTweensOf(t),u.to(t,{alpha:1,rotation:Math.PI*2,width:270,height:270,ease:"sine.in",duration:.5}),await u.to(t,{x:A()?this.cardsLeftContainer.x-190:this.cardsLeftContainer.x,y:A()?this.cardsLeftContainer.y:this.cardsLeftContainer.y-50,width:5,height:5,ease:"sine.in",duration:.5,delay:1}),this.cardsLeftContainer.setNumber(o.currentState.ticketsLeft,!0),t.removeFromParent(),this.setButtonEnabled(this.scratchButton,!0),this.setButtonEnabled(this.autoplayButton,!0)}setButtonEnabled(t,e){t.enabled=e,t.alpha=e?1:.6}showLoading(t){t?(this.paytableContainer.visible=!1,this.buyTicketContainer.visible=!1,this.scratchPan&&(this.scratchPan.visible=!1),this.loadingContainer.show()):(this.prevFrameContent==="buyNow"&&(this.buyTicketContainer.visible=!0),this.loadingContainer.hide()),this.loadingContainer.visible=t}onRequestErrorHandler(t){c.presentPopup(st,t),this.showLoading(!1),this.eventMode="static"}setAllButtonState(t){this.setButtonEnabled(this.scratchButton,t),this.setButtonEnabled(this.autoplayButton,t),this.setButtonEnabled(this.paytableButton,t)}}n(Bt,"assetBundles",["home"]);class kt extends m{constructor(){super();n(this,"loading");n(this,"companyLogo");n(this,"progressBar");n(this,"progressBarBg");n(this,"progressBarFill");n(this,"onProgress",t=>{this.progressBar.progress=t*100});this.loading=new m,this.addChild(this.loading),this.companyLogo=new te,this.companyLogo.y=-40,this.loading.addChild(this.companyLogo),this.progressBarBg=new S,this.progressBarBg.beginFill(3355443),this.progressBarBg.drawRoundedRect(0,0,300,10,5),this.progressBarBg.endFill(),this.progressBarFill=new S,this.progressBarFill.beginFill(14561865),this.progressBarFill.drawRoundedRect(0,0,300,10,5),this.progressBarFill.endFill(),this.progressBar=new Et({bg:this.progressBarBg,fill:this.progressBarFill,progress:0}),this.progressBar.y=40,this.progressBar.x=-150,this.loading.addChild(this.progressBar),this.loading.alpha=0}resize(t,e){this.loading.x=t*.5,this.loading.y=e*.5}async show(){u.killTweensOf(this.loading),await u.to(this.loading,{alpha:1,duration:1,ease:"linear"});const t=qt();await ot(t,this.onProgress),c.setBackground(se),c.showScreen(Bt)}async hide(){u.killTweensOf(this.loading),await u.to(this.loading,{alpha:0,duration:1,ease:"linear"})}}n(kt,"assetBundles",["preload"]);const k=new zt({resolution:window.devicePixelRatio,backgroundColor:Ot,width:W,height:b});function yt(){const r=window.innerWidth,i=window.innerHeight;let t=r/i,e,s;const a=W/b;r>i?(t>a?(e=i*a,s=i):(e=r,s=r/a),k.renderer.resize(W,b),c.resize(W,b)):(t=i/r,t>a?(e=r,s=r*a,k.renderer.resize(b/a,b),c.resize(b/a,b)):(e=r,s=i,k.renderer.resize(b/t,b),c.resize(b/t,b))),k.renderer.view.style.width=`${e}px`,k.renderer.view.style.height=`${s}px`,window.scrollTo(0,0)}function be(){document.hidden?(et.pauseAll(),c.blur()):(et.resumeAll(),c.focus())}async function we(){await Se()?(document.body.appendChild(k.view),window.addEventListener("resize",yt),yt(),document.addEventListener("visibilitychange",be),await Yt(),await c.showScreen(kt)):document.write("Server Error!")}async function Se(){try{const r=await G.get(`${j}/${X}/info`);return o.setGameState({credit:r.data.balance,currency:r.data.currency,ticketPrice:r.data.ticketPrice,ticketsLeft:r.data.ticketsLeft,ticketPool:r.data.ticketPool,prizes:r.data.prizes,nextCards:r.data.nextCards||[]}),!0}catch(r){return console.error(r),!1}}we();
